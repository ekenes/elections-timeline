import{a as k,n as Y,m as ks}from"./TimeOnly-45af311b.js";import{h6 as dr,iB as U,iZ as qs,iY as He,lv as Ye,lw as me,cy as Hs,aP as or,iC as Ys}from"./index-76dad814.js";var d;(function(i){i.InvalidFunctionParameters="InvalidFunctionParameters",i.InvalidValueForAggregateFunction="InvalidValueForAggregateFunction",i.UnsupportedSqlFunction="UnsupportedSqlFunction",i.UnsupportedOperator="UnsupportedOperator",i.UnsupportedSyntax="UnsupportedSyntax",i.UnsupportedIsRhs="UnsupportedIsRhs",i.UnsupportedIsLhs="UnsupportedIsLhs",i.InvalidDataType="InvalidDataType",i.CannotCastValue="CannotCastValue",i.FunctionNotRecognized="FunctionNotRecognized",i.InvalidTime="InvalidTime",i.InvalidParameterCount="InvalidParameterCount",i.InvalidTimeStamp="InvalidTimeStamp",i.InvalidDate="InvalidDate",i.InvalidOperator="InvalidOperator",i.IllegalInterval="IllegalInterval",i.YearMonthIntervals="YearMonthIntervals",i.PrimarySecondaryQualifiers="PrimarySecondaryQualifiers",i.MissingStatisticParameters="MissingStatisticParameters"})(d||(d={}));const js={[d.InvalidValueForAggregateFunction]:"Invalid value used in aggregate function",[d.MissingStatisticParameters]:"Statistic does not have 1 or 0 Parameters",[d.InvalidFunctionParameters]:"Invalid parameters for call to {function}",[d.UnsupportedIsLhs]:"Unsupported left hand expression in is statement",[d.UnsupportedIsRhs]:"Unsupported right hand expression in is statement",[d.UnsupportedOperator]:"Unsupported operator - {operator}",[d.UnsupportedSyntax]:"Unsupported syntax - {node}",[d.UnsupportedSqlFunction]:"Sql function not found = {function}",[d.InvalidDataType]:"Invalid sql data type",[d.InvalidDate]:"Invalid date encountered",[d.InvalidOperator]:"Invalid operator encountered",[d.InvalidTime]:"Invalid time encountered",[d.IllegalInterval]:"Illegal interval",[d.FunctionNotRecognized]:"Function not recognized",[d.InvalidTimeStamp]:"Invalid timestamp encountered",[d.InvalidParameterCount]:"Invalid parameter count for call to {name}",[d.PrimarySecondaryQualifiers]:"Primary and Secondary SqlInterval qualifiers not supported",[d.YearMonthIntervals]:"Year-Month Intervals not supported",[d.CannotCastValue]:"Cannot cast value to the required data type"};let m=class pr extends Error{constructor(a,u){super(dr(js[a],u)),this.declaredRootClass="esri.arcade.featureset.support.sqlerror",Error.captureStackTrace&&Error.captureStackTrace(this,pr)}};var B;(function(i){i.NeverReach="NeverReach",i.NotImplemented="NotImplemented",i.Cancelled="Cancelled",i.InvalidStatResponse="InvalidStatResponse",i.InvalidRequest="InvalidRequest",i.RequestFailed="RequestFailed",i.MissingFeatures="MissingFeatures",i.AggregationFieldNotFound="AggregationFieldNotFound",i.DataElementsNotFound="DataElementsNotFound"})(B||(B={}));const Bs={[B.Cancelled]:"Cancelled",[B.InvalidStatResponse]:"Invalid statistics response from service",[B.InvalidRequest]:"Invalid request",[B.RequestFailed]:"Request failed - {reason}",[B.MissingFeatures]:"Missing features",[B.AggregationFieldNotFound]:"Aggregation field not found",[B.DataElementsNotFound]:"Data elements not found on service",[B.NeverReach]:"Encountered unreachable logic",[B.NotImplemented]:"Not implemented"};let xc=class mr extends Error{constructor(a,u){super(dr(Bs[a],u)),this.declaredRootClass="esri.arcade.featureset.support.featureseterror",Error.captureStackTrace&&Error.captureStackTrace(this,mr)}};function ur(i){return Number.isNaN(i)||i===0?i:Math.trunc(i)}let W=class le{constructor(a){this._timeStampOffset=a,this._date=null}toDateTime(){return this._date??(this._date=U.fromISO(this._timeStampOffset,{setZone:!0})),this._date}get isValid(){return this.toDateTime().isValid}get timezoneOffsetHour(){return ur(this.toDateTime().offset/60)}get timezoneOffsetMinutes(){return ur(this.toDateTime().offset%60)}toMilliseconds(){return this.toDateTime().toMillis()}get hour(){return this.toDateTime().hour}get minute(){return this.toDateTime().minute}get second(){return this.toDateTime().second}get day(){return this.toDateTime().day}get month(){return this.toDateTime().month}get year(){return this.toDateTime().year}startOfDay(){return le.fromDateTime(this.toDateTime().startOf("day"))}static fromJSDate(a){return new le(U.fromJSDate(a).toISO({includeOffset:!0}))}static fromDateTime(a){return new le(a.toISO({includeOffset:!0}))}static fromParts(a,u,t=0,l=0,v=0,g=0,T=0,O=!1,N=0,C=0){const P=`${a.toString().padStart(4,"0")}-${u.toString().padStart(2,"0")}-${t.toString().padStart(2,"0")}`;let F="";g<10&&(F="0");let ee=`${l.toString().padStart(2,"0")}:${v.toString().padStart(2,"0")}:${F+g.toString()}`;T!==0&&(ee+="."+T.toString().padStart(3,"0"));const te=`${O?"-":"+"}${N.toString().padStart(2,"0")}:${C.toString().padStart(2,"0")}`;return new le(P+"T"+ee+te)}toStorageFormat(){return this._timeStampOffset}toString(){return this._timeStampOffset}toSQLValue(){let a=this.toDateTime().toSQL({includeOffset:!0,includeOffsetSpace:!0});return a&&(a=a.replace(".000","")),a}toSQLWithKeyword(){return`timestamp '${this.toSQLValue()}'`}addMilliseconds(a){const u=this.toDateTime().plus(a);return le.fromDateTime(u)}};function Qs(i,a){const u=vr[i.toLowerCase()];if(u==null)throw new m(d.FunctionNotRecognized);if(a.length<u.minParams||a.length>u.maxParams)throw new m(d.InvalidParameterCount,{name:i.toUpperCase()});return u.evaluate(a)}function sr(i,a){const u=vr[i.toLowerCase()];return u!=null&&a>=u.minParams&&a<=u.maxParams}const vr={min:{minParams:1,maxParams:1,evaluate:i=>lr(i[0],"min")},max:{minParams:1,maxParams:1,evaluate:i=>lr(i[0],"max")},avg:{minParams:1,maxParams:1,evaluate:i=>hr(i[0])},sum:{minParams:1,maxParams:1,evaluate:i=>Ws(i[0])},stddev:{minParams:1,maxParams:1,evaluate:i=>Gs(i[0])},count:{minParams:1,maxParams:1,evaluate:i=>i[0]==null?null:i[0].length},var:{minParams:1,maxParams:1,evaluate:i=>wr(i[0])}};function hr(i){if(i===null)return null;let a=0,u=0;for(let t=0;t<i.length;t++){const l=i[t];if(l!==null){if(!et(l))throw new m(d.InvalidValueForAggregateFunction);u++,a+=l}}return u===0?null:a/i.length}function et(i){return typeof i=="number"}function lr(i,a){if(i===null)return null;let u=null,t=null;for(const l of i){let v=l;v=l instanceof k||l instanceof Y?l.toNumber():l instanceof U?l.toMillis():l instanceof W?l.toMilliseconds():l,(u===null||a==="max"&&t!==null&&v!==null&&t<=v||a==="min"&&t!==null&&v!==null&&t>=v)&&(u=l,t=v)}return u}function Ws(i){if(i===null)return null;let a=0;for(let u=0;u<i.length;u++){const t=i[u];if(t!==null){if(!et(t))throw new m(d.InvalidValueForAggregateFunction);a+=t}}return a}function Gs(i){if(i===null)return null;const a=wr(i);return a===null?null:Math.sqrt(a)}function wr(i){if(i===null||(i=i.filter(t=>t!==null)).length===0)return null;const a=hr(i);if(a===null)return null;let u=0;for(const t of i){if(!et(t))throw new m(d.InvalidValueForAggregateFunction);u+=(a-t)**2}return u/(i.length-1)}class E{constructor(){this.op="+",this.day=0,this.second=0,this.hour=0,this.month=0,this.year=0,this.minute=0,this.millis=0}static _fixDefaults(a){if(a.precision!==null||a.secondary!==null)throw new m(d.PrimarySecondaryQualifiers)}static _parseSecondsComponent(a,u){if(u.includes(".")){const t=u.split(".");a.second=parseFloat(t[0]),a.millis=parseInt(t[1],10)}else a.second=parseFloat(u)}static createFromMilliseconds(a){const u=new E;return u.second=a/1e3,u}static createFromValueAndQualifier(a,u,t){let l=null;const v=new E;if(v.op=t==="-"?"-":"+",u.type==="interval-period"){E._fixDefaults(u);const g=new RegExp("^[0-9]{1,}$");if(u.period==="year"||u.period==="month")throw new m(d.YearMonthIntervals);if(u.period==="second"){if(!/^[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/.test(a))throw new m(d.IllegalInterval);E._parseSecondsComponent(v,a)}else{if(!g.test(a))throw new m(d.IllegalInterval);v[u.period]=parseFloat(a)}}else{if(E._fixDefaults(u.start),E._fixDefaults(u.end),u.start.period==="year"||u.start.period==="month"||u.end.period==="year"||u.end.period==="month")throw new m(d.YearMonthIntervals);switch(u.start.period){case"day":switch(u.end.period){case"hour":if(l=new RegExp("^[0-9]{1,} [0-9]{1,}$"),!l.test(a))throw new m(d.IllegalInterval);v[u.start.period]=parseFloat(a.split(" ")[0]),v[u.end.period]=parseFloat(a.split(" ")[1]);break;case"minute":if(l=new RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,}$"),!l.test(a))throw new m(d.IllegalInterval);{v[u.start.period]=parseFloat(a.split(" ")[0]);const g=a.split(" ")[1].split(":");v.hour=parseFloat(g[0]),v.minute=parseFloat(g[1])}break;case"second":if(l=new RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$"),!l.test(a))throw new m(d.IllegalInterval);{v[u.start.period]=parseFloat(a.split(" ")[0]);const g=a.split(" ")[1].split(":");v.hour=parseFloat(g[0]),v.minute=parseFloat(g[1]),E._parseSecondsComponent(v,g[2])}break;default:throw new m(d.IllegalInterval)}break;case"hour":switch(u.end.period){case"minute":if(l=new RegExp("^[0-9]{1,}:[0-9]{1,}$"),!l.test(a))throw new m(d.IllegalInterval);v.hour=parseFloat(a.split(":")[0]),v.minute=parseFloat(a.split(":")[1]);break;case"second":if(l=new RegExp("^[0-9]{1,}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$"),!l.test(a))throw new m(d.IllegalInterval);{const g=a.split(":");v.hour=parseFloat(g[0]),v.minute=parseFloat(g[1]),E._parseSecondsComponent(v,g[2])}break;default:throw new m(d.IllegalInterval)}break;case"minute":if(u.end.period!=="second")throw new m(d.IllegalInterval);if(l=new RegExp("^[0-9]{1,}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$"),!l.test(a))throw new m(d.IllegalInterval);{const g=a.split(":");v.minute=parseFloat(g[0]),E._parseSecondsComponent(v,g[1])}break;default:throw new m(d.IllegalInterval)}}return v}valueInMilliseconds(){return(this.op==="-"?-1:1)*(this.millis+1e3*this.second+60*this.minute*1e3+60*this.hour*60*1e3+24*this.day*60*60*1e3+this.month*(365/12)*24*60*60*1e3+365*this.year*24*60*60*1e3)}}const Ks=/^(\d{1,2}):(\d{1,2}):(\d{1,2})$/,Xs=/^(\d{1,2}):(\d{1,2})$/,el=/^(\d{1,2}):(\d{1,2}):(\d{1,2}).([0-9]+)$/,Ir=/^(\d{4})-(\d{1,2})-(\d{1,2})$/,tl=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?$/,rl=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?[ ]{0,1}(\+|-)(\d{1,2}):(\d{1,2})$/,nl=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})?[ ]{0,1}(\+|-)(\d{1,2}):(\d{1,2})$/,al=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/;function Pe(i,a){if(a instanceof qs)return a===He.instance?U.fromMillis(i.getTime(),{zone:He.instance}):U.fromJSDate(i,{zone:a});switch(a){case"system":case"local":case null:return U.fromJSDate(i);default:return(a==null?void 0:a.toLowerCase())==="unknown"?U.fromMillis(i.getTime(),{zone:He.instance}):U.fromJSDate(i,{zone:a})}}function V(i){return typeof i=="number"}function J(i){return typeof i=="string"||i instanceof String}function X(i){return i instanceof E}function H(i){return i instanceof Date}function $(i){return i instanceof U}function b(i){return i instanceof k}function D(i){return i instanceof Y}function A(i){return i instanceof W}function tt(i){let a=Ks.exec(i);if(a!==null){const[,u,t,l]=a,v=Y.fromParts(parseInt(u,10),parseInt(t,10),parseInt(l,10),0);if(v!==null)return v;throw new m(d.InvalidTime)}if(a=Xs.exec(i),a!==null){const[,u,t]=a,l=Y.fromParts(parseInt(u,10),parseInt(t,10),0,0);if(l!==null)return l;throw new m(d.InvalidTime)}if(a=el.exec(i),a!==null){const[,u,t,l,v]=a,g=Y.fromParts(parseInt(u,10),parseInt(t,10),parseInt(l,10),parseInt(v,10));if(g!==null)return g;throw new m(d.InvalidTime)}throw new m(d.InvalidTime)}function De(i,a,u=!1){let t=tl.exec(i);if(t!==null){const[,l,v,g,T,O,N,C]=t,P=U.fromObject({year:parseInt(l,10),month:parseInt(v,10),day:parseInt(g,10),hour:parseInt(T,10),minute:parseInt(O,10),second:parseInt(N,10),millisecond:C?parseInt(C.replace(".",""),10):0},{zone:Ye(a)});if(P.isValid===!1)throw new m(d.InvalidTimeStamp);return P}if(t=rl.exec(i),t!==null){const[,l,v,g,T,O,N,C,P,F,ee]=t,te=W.fromParts(parseInt(l,10),parseInt(v,10),parseInt(g,10),parseInt(T,10),parseInt(O,10),parseInt(N,10),C?parseInt(C.replace(".",""),10):0,P==="-",parseInt(F,10),parseInt(ee,10));if(te.isValid===!1)throw new m(d.InvalidTimeStamp);return te}if(t=nl.exec(i),t!==null){const[,l,v,g,T,O,N,C,P]=t,F=W.fromParts(parseInt(l,10),parseInt(v,10),parseInt(g,10),parseInt(T,10),parseInt(O,10),0,0,N==="-",parseInt(C,10),parseInt(P,10));if(F.isValid===!1)throw new m(d.InvalidTimeStamp);return F}if(t=al.exec(i),t!==null){const[,l,v,g,T,O]=t,N=U.fromObject({year:parseInt(l,10),month:parseInt(v,10),day:parseInt(g,10),hour:parseInt(T,10),minute:parseInt(O,10),second:0},{zone:Ye(a)});if(N.isValid===!1)throw new m(d.InvalidTimeStamp);return N}if(t=Ir.exec(i),t!==null){const[,l,v,g]=t,T=U.fromObject({year:parseInt(l,10),month:parseInt(v,10),day:parseInt(g,10),hour:0,minute:0,second:0},{zone:Ye(a)});if(T.isValid===!1)throw new m(d.InvalidTimeStamp);return T}throw new m(d.InvalidTimeStamp)}function gr(i,a){const u=Ir.exec(i);if(u===null)try{return De(i,a)}catch{throw new m(d.InvalidDate)}const[,t,l,v]=u,g=k.fromParts(parseInt(t,10),parseInt(l,10),parseInt(v,10));if(g===null)throw new m(d.InvalidDate);return g}const il=321408e5,ol=26784e5,ul=864e5,sl=36e5,ll=6e4;function je(i){return!!$(i)||!!A(i)}function We(i){return!!$(i)||!!b(i)||!!A(i)||!!D(i)}function be(i){if($(i))return i.toMillis();if(b(i))return i.toNumber();if(A(i))return i.toMilliseconds();throw new m(d.InvalidDataType)}function z(i,a,u,t){if(i==null||a==null)return null;if(V(i)){if(V(a))return Q(i,a,u);if(J(a))return cl(i,a,u);if(We(a))throw new m(d.InvalidOperator);if(b(a))throw new m(d.InvalidOperator)}else if(J(i)){if(V(a))return fl(i,a,u);if(J(a))return dl(i,a,u);if($(a))throw new m(d.InvalidOperator);if(b(a))throw new m(d.InvalidOperator);if(D(a))throw new m(d.InvalidOperator);if(A(a))throw new m(d.InvalidOperator)}else if($(i)){if(je(a)){if(i instanceof U&&me(i.zone)){if(a instanceof U&&me(a.zone)===!1||a instanceof W)return ve(i,a,u)}else if(a instanceof U&&me(a.zone)&&(i instanceof U&&me(i.zone)===!1||i instanceof W))return ve(i,a,u);return Q(be(i),be(a),u)}if(J(a))throw new m(d.InvalidOperator);if(b(a))return pl(i,a,u);if(D(a))throw new m(d.InvalidOperator);if(V(a))throw new m(d.InvalidOperator)}else if(b(i)){if(A(a))return hl(i,a,u);if($(a))return vl(i,a,u);if(J(a))throw new m(d.InvalidOperator);if(b(a))return Q(i.toNumber(),a.toNumber(),u);if(D(a))throw new m(d.InvalidOperator);if(V(a))throw new m(d.InvalidOperator)}else if(D(i)){if(D(a))return Q(i.toNumber(),a.toNumber(),u);if(J(a))throw new m(d.InvalidOperator);if(V(a))throw new m(d.InvalidOperator);if(b(a))throw new m(d.InvalidOperator);if(je(a))throw new m(d.InvalidOperator)}else if(A(i)){if(je(a))return a instanceof U&&me(a.zone)?ve(i,a,u):Q(be(i),be(a),u);if(J(a))throw new m(d.InvalidOperator);if(b(a))return ml(i,a,u);if(D(a))throw new m(d.InvalidOperator);if(V(a))throw new m(d.InvalidOperator)}switch(u){case"<>":return i!==a;case"=":return i===a;case">":return i>a;case"<":return i<a;case">=":return i>=a;case"<=":return i<=a}}function Q(i,a,u){switch(u){case"<>":return i!==a;case"=":return i===a;case">":return i>a;case"<":return i<a;case">=":return i>=a;case"<=":return i<=a}}function cl(i,a,u){const t=parseFloat(a);if(!isNaN(t))return Q(i,t,u);const l=i.toString();switch(u){case"<>":return l!==a;case"=":return l===a;case">":return l>a;case"<":return l<a;case">=":return l>=a;case"<=":return l<=a}}function fl(i,a,u){const t=parseFloat(i);if(!isNaN(t))return Q(t,a,u);const l=a.toString();switch(u){case"<>":return i!==l;case"=":return i===l;case">":return i>l;case"<":return i<l;case">=":return i>=l;case"<=":return i<=l}}function dl(i,a,u){switch(u){case"<>":return i!==a;case"=":return i===a;case">":return i>a;case"<":return i<a;case">=":return i>=a;case"<=":return i<=a}}function pl(i,a,u){const t=a.toDateTimeLuxon(i.zone);return Q((i=i.startOf("day")).toMillis(),t.toMillis(),u)}function ml(i,a,u){const t=a.toDateTimeLuxon(i.toDateTime().zone);return Q((i=i.startOfDay()).toMilliseconds(),t.toMillis(),u)}function vl(i,a,u){const t=i.toDateTimeLuxon(a.zone);return a=a.startOf("day"),Q(t.toMillis(),a.toMillis(),u)}function hl(i,a,u){const t=i.toDateTimeLuxon(a.toDateTime().zone);return a=a.startOfDay(),Q(t.toMillis(),a.toMilliseconds(),u)}function ve(i,a,u){i instanceof W&&(i=i.toDateTime()),a instanceof W&&(a=a.toDateTime());const t=cr(i),l=cr(a);switch(u){case"<>":return t!==l;case"=":return t===l;case">":return t>l;case"<":return t<l;case">=":return t>=l;case"<=":return t<=l}}function cr(i){return i.year*il+i.month*ol+i.day*ul+i.hour*sl+i.minute*ll+1e3*i.second+i.millisecond}function rt(i,a,u){const t=Tr[i.toLowerCase()];if(t==null)throw new m(d.FunctionNotRecognized);if(a.length<t.minParams||a.length>t.maxParams)throw new m(d.InvalidParameterCount,{name:i.toUpperCase()});return t.evaluate(a,u)}function wl(i,a){const u=Tr[i.toLowerCase()];return u!=null&&a>=u.minParams&&a<=u.maxParams}function Le(i){return typeof i=="string"||i instanceof String}function Be(i){return!H(i)&&!b(i)&&!$(i)&&!D(i)&&!A(i)}function yr(i){return b(i)||D(i)?i.toString():A(i)?i.toSQLValue():$(i)?i.millisecond===0?i.toFormat("yyyy-LL-dd HH:mm:ss"):i.toSQL({includeOffset:!1}):H(i)?yr(U.fromJSDate(i)):i.toString()}function Il(i){if(H(i))return k.fromDateJS(i);if($(i))return k.fromParts(i.year,i.month,i.day);if(b(i))return i;if(D(i))throw new m(d.CannotCastValue);if(A(i)&&k.fromParts(i.year,i.month,i.day)===null)throw new m(d.CannotCastValue);if(Le(i)){const a=k.fromReader(i);if(a!==null&&a.isValid)return a}throw new m(d.CannotCastValue)}function gl(i,a,u){if(H(i))return Pe(i,a);if($(i))return i;if(b(i))return i.toDateTimeLuxon("unknown");if(D(i))throw new m(d.CannotCastValue);if(A(i))return i;if(Le(i))return De(i,"unknown",u);throw new m(d.CannotCastValue)}function yl(i){if(H(i))return Y.fromDateJS(i);if($(i))return Y.fromDateTime(i);if(b(i))throw new m(d.CannotCastValue);if(D(i))return i;if(A(i))return Y.fromSqlTimeStampOffset(i);if(Le(i))return tt(i);throw new m(d.CannotCastValue)}const Tr={extract:{minParams:2,maxParams:2,evaluate:([i,a])=>{if(a==null)return null;if(H(a))switch(i.toUpperCase()){case"SECOND":return a.getSeconds();case"MINUTE":return a.getMinutes();case"HOUR":return a.getHours();case"DAY":return a.getDate();case"MONTH":return a.getMonth()+1;case"YEAR":return a.getFullYear();case"TIMEZONE_HOUR":case"TIMEZONE_MINUTE":return 0}else if($(a))switch(i.toUpperCase()){case"SECOND":return a.second;case"MINUTE":return a.minute;case"HOUR":return a.hour;case"DAY":return a.day;case"MONTH":return a.month;case"YEAR":return a.year;case"TIMEZONE_HOUR":case"TIMEZONE_MINUTE":throw new m(d.InvalidFunctionParameters,{function:"EXTRACT"})}else if(b(a))switch(i.toUpperCase()){case"DAY":return a.day;case"MONTH":return a.month;case"YEAR":return a.year;case"TIMEZONE_HOUR":case"TIMEZONE_MINUTE":throw new m(d.InvalidFunctionParameters,{function:"EXTRACT"})}else if(D(a))switch(i.toUpperCase()){case"SECOND":return a.second;case"MINUTE":return a.minute;case"HOUR":return a.hour}else if(A(a))switch(i.toUpperCase()){case"SECOND":return a.second;case"MINUTE":return a.minute;case"HOUR":return a.hour;case"DAY":return a.day;case"MONTH":return a.month;case"YEAR":return a.year;case"TIMEZONE_HOUR":return a.timezoneOffsetHour;case"TIMEZONE_MINUTE":return a.timezoneOffsetMinutes}throw new m(d.InvalidFunctionParameters,{function:"EXTRACT"})}},substring:{minParams:2,maxParams:3,evaluate:i=>{if(i.length===2){const[a,u]=i;return a==null||u==null?null:a.toString().substring(u-1)}if(i.length===3){const[a,u,t]=i;return a==null||u==null||t==null?null:t<=0?"":a.toString().substring(u-1,u+t-1)}}},position:{minParams:2,maxParams:2,evaluate:([i,a])=>i==null||a==null?null:a.indexOf(i)+1},trim:{minParams:2,maxParams:3,evaluate:i=>{const a=i.length===3,u=a?i[1]:" ",t=a?i[2]:i[1];if(u==null||t==null)return null;const l=`(${Hs(u)})`;switch(i[0]){case"BOTH":return t.replaceAll(new RegExp(`^${l}*|${l}*$`,"g"),"");case"LEADING":return t.replaceAll(new RegExp(`^${l}*`,"g"),"");case"TRAILING":return t.replaceAll(new RegExp(`${l}*$`,"g"),"")}throw new m(d.InvalidFunctionParameters,{function:"TRIM"})}},abs:{minParams:1,maxParams:1,evaluate:i=>i[0]==null?null:Math.abs(i[0])},ceiling:{minParams:1,maxParams:1,evaluate:i=>i[0]==null?null:Math.ceil(i[0])},floor:{minParams:1,maxParams:1,evaluate:i=>i[0]==null?null:Math.floor(i[0])},log:{minParams:1,maxParams:1,evaluate:i=>i[0]==null?null:Math.log(i[0])},log10:{minParams:1,maxParams:1,evaluate:i=>i[0]==null?null:Math.log(i[0])*Math.LOG10E},sin:{minParams:1,maxParams:1,evaluate:i=>i[0]==null?null:Math.sin(i[0])},cos:{minParams:1,maxParams:1,evaluate:i=>i[0]==null?null:Math.cos(i[0])},tan:{minParams:1,maxParams:1,evaluate:i=>i[0]==null?null:Math.tan(i[0])},asin:{minParams:1,maxParams:1,evaluate:i=>i[0]==null?null:Math.asin(i[0])},acos:{minParams:1,maxParams:1,evaluate:i=>i[0]==null?null:Math.acos(i[0])},atan:{minParams:1,maxParams:1,evaluate:i=>i[0]==null?null:Math.atan(i[0])},sign:{minParams:1,maxParams:1,evaluate:i=>i[0]==null?null:i[0]>0?1:i[1]<0?-1:0},power:{minParams:2,maxParams:2,evaluate:i=>i[0]==null||i[1]==null?null:i[0]**i[1]},mod:{minParams:2,maxParams:2,evaluate:i=>i[0]==null||i[1]==null?null:i[0]%i[1]},round:{minParams:1,maxParams:2,evaluate:i=>{const a=i[0],u=i.length===2?10**i[1]:1;return a==null?null:Math.round(a*u)/u}},truncate:{minParams:1,maxParams:2,evaluate:i=>i[0]==null?null:i.length===1?parseInt(i[0].toFixed(0),10):parseFloat(i[0].toFixed(i[1]))},char_length:{minParams:1,maxParams:1,evaluate:i=>Le(i[0])?i[0].length:0},concat:{minParams:1,maxParams:1/0,evaluate:i=>{let a="";for(let u=0;u<i.length;u++){if(i[u]==null)return null;a+=i[u].toString()}return a}},lower:{minParams:1,maxParams:1,evaluate:i=>i[0]==null?null:i[0].toString().toLowerCase()},upper:{minParams:1,maxParams:1,evaluate:i=>i[0]==null?null:i[0].toString().toUpperCase()},coalesce:{minParams:1,maxParams:1/0,evaluate:i=>{for(const a of i)if(a!==null)return a;return null}},cosh:{minParams:1,maxParams:1,evaluate:i=>i[0]==null?null:Math.cosh(i[0])},sinh:{minParams:1,maxParams:1,evaluate:i=>i[0]==null?null:Math.sinh(i[0])},tanh:{minParams:1,maxParams:1,evaluate:i=>i[0]==null?null:Math.tanh(i[0])},nullif:{minParams:2,maxParams:2,evaluate:(i,a)=>z(i[0],i[1],"=")?null:i[0]},cast:{minParams:2,maxParams:2,evaluate:(i,a)=>{const u=i[0],t=i[1];if(u===null)return null;switch(t.type){case"integer":{if(!Be(u))throw new m(d.CannotCastValue);const l=parseInt(u,10);if(isNaN(l))throw new m(d.CannotCastValue);return l}case"smallint":{if(!Be(u))throw new m(d.CannotCastValue);const l=parseInt(u,10);if(isNaN(l))throw new m(d.CannotCastValue);if(l>32767||l<-32767)throw new m(d.CannotCastValue);return l}case"float":case"real":{if(!Be(u))throw new m(d.CannotCastValue);const l=parseFloat(u);if(isNaN(l))throw new m(d.CannotCastValue);return l}case"time":return yl(u);case"date":return Il(u);case"timestamp":return gl(u,a,t.withtimezone===!0);case"varchar":{const l=yr(u);if(l.length>t.size)throw new m(d.CannotCastValue);return l}default:throw new m(d.InvalidDataType)}}}};function Nr(i,a,u,t){if(i==="||")return rt("concat",[a,u],t);if(a===null||u===null)return null;if(V(a)){if(V(u))return nt(a,u,i);if(X(u))return El(a,u,i);if(D(u))return Ul();if(b(u))return Vl();if(A(u))return _l();if($(u))return Ll();if(J(u))return Jl(a,u,i);throw new m(d.InvalidOperator)}if(b(a)){if(V(u))return Pl(a,u,i);if(X(u))return Fl(a,u,i);if(D(u))return Bl();if(b(u))return jl(a,u,i);if(A(u))return Yl(a,u,i);if($(u))return Hl(a,u,i);if(J(u))return uc();throw new m(d.InvalidOperator)}if(D(a)){if(V(u))return Dl(a,u,i);if(X(u))return Ol(a,u,i);if(D(u))return rc();if(b(u))return ec();if(A(u))return tc();if($(u))return Xl();if(J(u))return sc();throw new m(d.InvalidOperator)}if(X(a)){if(V(u))return Ml(a,u,i);if(X(u))return Cl(a,u,i);if(D(u))return Nl(a,u,i);if(b(u))return Sl(a,u,i);if(A(u))return xl(a,u,i);if($(u))return Tl(a,u,i);if(J(u))return kl();throw new m(d.InvalidOperator)}if($(a)){if(V(u))return Al(a,u,i);if(X(u))return $l(a,u,i);if(D(u))return oc();if(b(u))return ac(a,u,i);if(A(u))return ic(a,u,i);if($(u))return nc(a,u,i);if(J(u))return lc();throw new m(d.InvalidOperator)}if(A(a)){if(V(u))return Rl(a,u,i);if(X(u))return bl(a,u,i);if(D(u))return Ql();if(b(u))return Wl(a,u,i);if(A(u))return Kl(a,u,i);if($(u))return Gl(a,u,i);if(J(u))return cc();throw new m(d.InvalidOperator)}if(J(a)){if(V(u))return Zl(a,u,i);if(X(u))return ql();if(D(u))return fc();if(b(u))return dc();if(A(u))return mc();if($(u))return pc();if(J(u))return zl(a,u,i);throw new m(d.InvalidOperator)}throw new m(d.InvalidOperator)}function nt(i,a,u){switch(u){case"+":return i+a;case"-":return i-a;case"*":return i*a;case"/":return i/a}throw new m(d.InvalidOperator)}function Tl(i,a,u){switch(u){case"+":return a.plus({milliseconds:i.valueInMilliseconds()});case"-":return i.valueInMilliseconds()-a.toMillis()}throw new m(d.InvalidOperator)}function Nl(i,a,u){if(u==="+")return a.plus("milliseconds",i.valueInMilliseconds());throw new m(d.InvalidOperator)}function Sl(i,a,u){if(u==="+")return a.plus("milliseconds",i.valueInMilliseconds());throw new m(d.InvalidOperator)}function Ol(i,a,u){switch(u){case"+":return i.plus("milliseconds",a.valueInMilliseconds());case"-":return i.plus("milliseconds",-1*a.valueInMilliseconds())}throw new m(d.InvalidOperator)}function xl(i,a,u){if(u==="+")return a.addMilliseconds(i.valueInMilliseconds());throw new m(d.InvalidOperator)}function Cl(i,a,u){switch(u){case"+":return E.createFromMilliseconds(i.valueInMilliseconds()+a.valueInMilliseconds());case"-":return E.createFromMilliseconds(i.valueInMilliseconds()-a.valueInMilliseconds());case"*":return E.createFromMilliseconds(i.valueInMilliseconds()*a.valueInMilliseconds());case"/":return E.createFromMilliseconds(i.valueInMilliseconds()/a.valueInMilliseconds())}throw new m(d.InvalidOperator)}function Ml(i,a,u){switch(u){case"+":return E.createFromMilliseconds(i.valueInMilliseconds()+a);case"-":return E.createFromMilliseconds(i.valueInMilliseconds()-a);case"*":return E.createFromMilliseconds(i.valueInMilliseconds()*a);case"/":return E.createFromMilliseconds(i.valueInMilliseconds()/a)}throw new m(d.InvalidOperator)}function El(i,a,u){switch(u){case"+":return E.createFromMilliseconds(i+a.valueInMilliseconds());case"-":return E.createFromMilliseconds(i-a.valueInMilliseconds());case"*":return E.createFromMilliseconds(i*a.valueInMilliseconds());case"/":return E.createFromMilliseconds(i/a.valueInMilliseconds())}throw new m(d.InvalidOperator)}function Fl(i,a,u){switch(u){case"+":return i.plus("milliseconds",a.valueInMilliseconds());case"-":return i.plus("milliseconds",-1*a.valueInMilliseconds())}throw new m(d.InvalidOperator)}function $l(i,a,u){switch(u){case"+":return i.plus({milliseconds:a.valueInMilliseconds()});case"-":return i.minus({milliseconds:a.valueInMilliseconds()})}throw new m(d.InvalidOperator)}function bl(i,a,u){switch(u){case"+":return i.addMilliseconds(a.valueInMilliseconds());case"-":return i.addMilliseconds(-1*a.valueInMilliseconds())}throw new m(d.InvalidOperator)}function Al(i,a,u){const t=1e3*a*24*60*60;switch(u){case"+":return i.plus({milliseconds:t});case"-":return i.minus({milliseconds:t})}throw new m(d.InvalidOperator)}function Pl(i,a,u){const t=1e3*a*24*60*60;switch(u){case"+":return i.plus("milliseconds",t);case"-":return i.plus("milliseconds",-1*t)}throw new m(d.InvalidOperator)}function Dl(i,a,u){const t=1e3*a*24*60*60;switch(u){case"+":return i.plus("milliseconds",t);case"-":return i.plus("milliseconds",-1*t)}throw new m(d.InvalidOperator)}function Ll(i,a,u){throw new m(d.InvalidOperator)}function Rl(i,a,u){const t=1e3*a*24*60*60;switch(u){case"+":return i.addMilliseconds(t);case"-":return i.addMilliseconds(-1*t)}throw new m(d.InvalidOperator)}function _l(i,a,u){throw new m(d.InvalidOperator)}function Ul(i,a,u){throw new m(d.InvalidOperator)}function Vl(i,a,u){throw new m(d.InvalidOperator)}function Jl(i,a,u){const t=parseFloat(a);if(isNaN(t))throw new m(d.InvalidOperator);return nt(i,t,u)}function Zl(i,a,u){const t=parseFloat(i);if(isNaN(t))throw new m(d.InvalidOperator);return nt(t,a,u)}function zl(i,a,u){if(u==="+")return i+a;throw new m(d.InvalidOperator)}function kl(i,a,u){throw new m(d.InvalidOperator)}function ql(i,a,u){throw new m(d.InvalidOperator)}function Hl(i,a,u){if(u==="-")return i.toDateTimeLuxon(a.zone).diff(a).as("days");throw new m(d.InvalidOperator)}function Yl(i,a,u){if(u==="-")return i.toDateTimeLuxon(a.toDateTime().zone).diff(a.toDateTime()).as("days");throw new m(d.InvalidOperator)}function jl(i,a,u){if(u==="-")return i.toDateTimeLuxon("UTC").diff(a.toDateTimeLuxon("UTC")).as("days");throw new m(d.InvalidOperator)}function Bl(i,a,u){throw new m(d.InvalidOperator)}function Ql(i,a,u){throw new m(d.InvalidOperator)}function Wl(i,a,u){if(u==="-")return i.toDateTime().diff(a.toDateTimeLuxon(i.toDateTime().zone)).as("days");throw new m(d.InvalidOperator)}function Gl(i,a,u){if(u==="-")return i.toDateTime().diff(a).as("days");throw new m(d.InvalidOperator)}function Kl(i,a,u){if(u==="-")return i.toDateTime().diff(a.toDateTime()).as("days");throw new m(d.InvalidOperator)}function Xl(i,a,u){throw new m(d.InvalidOperator)}function ec(i,a,u){throw new m(d.InvalidOperator)}function tc(i,a,u){throw new m(d.InvalidOperator)}function rc(i,a,u){throw new m(d.InvalidOperator)}function nc(i,a,u){if(u==="-")return i.diff(a).as("days");throw new m(d.InvalidOperator)}function ac(i,a,u){if(u==="-")return i.diff(a.toDateTimeLuxon(i.zone)).as("days");throw new m(d.InvalidOperator)}function ic(i,a,u){if(u==="-")return i.diff(a.toDateTime()).as("days");throw new m(d.InvalidOperator)}function oc(i,a,u){throw new m(d.InvalidOperator)}function uc(i,a,u){throw new m(d.InvalidOperator)}function sc(i,a,u){throw new m(d.InvalidOperator)}function lc(i,a,u){throw new m(d.InvalidOperator)}function cc(i,a,u){throw new m(d.InvalidOperator)}function fc(i,a,u){throw new m(d.InvalidOperator)}function dc(i,a,u){throw new m(d.InvalidOperator)}function pc(i,a,u){throw new m(d.InvalidOperator)}function mc(i,a,u){throw new m(d.InvalidOperator)}function vc(i,a){function u(){this.constructor=i}u.prototype=a.prototype,i.prototype=new u}function ue(i,a,u,t){var l=Error.call(this,i);return Object.setPrototypeOf&&Object.setPrototypeOf(l,ue.prototype),l.expected=a,l.found=u,l.location=t,l.name="SyntaxError",l}function Qe(i,a,u){return u=u||" ",i.length>a?i:(a-=i.length,i+(u+=u.repeat(a)).slice(0,a))}function hc(i,a){var u,t={},l=(a=a!==void 0?a:{}).grammarSource,v={start:St},g=St,T="!",O="=",N=">=",C=">",P="<=",F="<>",ee="!=",te="||",Er="@",at="'",it="N'",he="''",Fr=".",$r="null",br="true",Ar="false",Pr="in",Dr="is",Lr="like",Rr="escape",_r="not",Ur="and",Vr="or",Jr="between",Zr="from",zr="for",kr="substring",qr="extract",Hr="trim",Yr="position",jr="timestamp",Br="date",Qr="time",Wr="leading",Gr="trailing",Kr="both",Xr="cast",en="as",tn="integer",rn="smallint",nn="float",an="real",on="varchar",un="to",sn="interval",ln="year",cn="timezone_hour",fn="timezone_minute",dn="month",pn="day",mn="hour",vn="minute",hn="second",wn="case",In="end",gn="when",yn="then",Tn="else",Nn=",",Sn="(",On=")",ot="`",xn=/^[<-=]/,we=/^[+\-]/,Cn=/^[*\/]/,Mn=/^[A-Za-z_\x80-\uFFFF]/,En=/^[A-Za-z0-9_]/,ut=/^[A-Za-z0-9_.\x80-\uFFFF]/,Fn=/^["]/,st=/^[^']/,$n=/^[0-9]/,bn=/^[eE]/,An=/^[ \t\n\r]/,lt=/^[^`]/,Pn=y("!",!1),Dn=y("=",!1),Ln=y(">=",!1),Rn=y(">",!1),_n=y("<=",!1),Un=y("<>",!1),Vn=q([["<","="]],!1,!1),Jn=y("!=",!1),Ie=q(["+","-"],!1,!1),Zn=y("||",!1),zn=q(["*","/"],!1,!1),kn=q([["A","Z"],["a","z"],"_",["","￿"]],!1,!1),qn=q([["A","Z"],["a","z"],["0","9"],"_"],!1,!1),ct=q([["A","Z"],["a","z"],["0","9"],"_",".",["","￿"]],!1,!1),Hn=q(['"'],!1,!1),Yn=y("@",!1),ft=y("'",!1),jn=y("N'",!1),dt=y("''",!1),pt=q(["'"],!0,!1),Bn=y(".",!1),Qn=q([["0","9"]],!1,!1),Wn=q(["e","E"],!1,!1),Gn=y("NULL",!0),Kn=y("TRUE",!0),Xn=y("FALSE",!0),ea=y("IN",!0),ta=y("IS",!0),ra=y("LIKE",!0),na=y("ESCAPE",!0),aa=y("NOT",!0),ia=y("AND",!0),oa=y("OR",!0),ua=y("BETWEEN",!0),sa=y("FROM",!0),la=y("FOR",!0),ca=y("SUBSTRING",!0),fa=y("EXTRACT",!0),da=y("TRIM",!0),pa=y("POSITION",!0),ma=y("TIMESTAMP",!0),va=y("DATE",!0),ha=y("TIME",!0),wa=y("LEADING",!0),Ia=y("TRAILING",!0),ga=y("BOTH",!0),ya=y("CAST",!0),Ta=y("AS",!0),Na=y("INTEGER",!0),Sa=y("SMALLINT",!0),Oa=y("FLOAT",!0),xa=y("REAL",!0),Ca=y("VARCHAR",!0),Ma=y("TO",!0),Ea=y("INTERVAL",!0),Fa=y("YEAR",!0),$a=y("TIMEZONE_HOUR",!0),ba=y("TIMEZONE_MINUTE",!0),Aa=y("MONTH",!0),Pa=y("DAY",!0),Da=y("HOUR",!0),La=y("MINUTE",!0),Ra=y("SECOND",!0),_a=y("CASE",!0),Ua=y("END",!0),Va=y("WHEN",!0),Ja=y("THEN",!0),Za=y("ELSE",!0),za=y(",",!1),ka=y("(",!1),qa=y(")",!1),Ha=q([" ","	",`
`,"\r"],!1,!1),mt=y("`",!1),vt=q(["`"],!0,!1),Ya=function(e){return e},ja=function(e){return Z(I(),...e)},ht=function(e,r,o){return{op:r,expr:o,location:I()}},Ba=function(e,r){return pe(e,r)},wt=function(e,r,o){return{op:r,expr:o,location:I()}},Qa=function(e,r){return pe(e,r)},Wa=function(e){return Vs("NOT",e,I())},Ga=function(e,r){return r==""||r==null||r==null?e:r.type=="arithmetic"?pe(e,r.tail):ar(r.op,e,r.right,r.escape,I())},It=function(e,r){return{op:e,expr:r,location:I()}},Ka=function(e){return{type:"arithmetic",tail:e}},Xa=function(e,r){return{op:e+"NOT",right:r}},ei=function(e,r){return{op:e,right:r}},ti=function(e,r,o){return Z(I(),r,o)},ri=function(e,r){return{op:"NOT"+e,right:r}},ni=function(e,r,o){return Z(I(),r,o)},ai=function(e,r){return{op:e,right:r}},ii=function(e){return e[0]+" "+e[2]},oi=function(e){return e[0]+" "+e[2]},ui=function(e,r,o){return{op:e,right:r,escape:o.value}},si=function(e,r){return{op:e,right:r,escape:""}},li=function(e,r){return{op:e,right:r}},ci=function(e,r){return{op:e,right:r}},gt=function(e,r,o){return{op:r,expr:o,location:I()}},fi=function(e,r){return pe(e,r)},yt=function(e,r,o){return{op:r,expr:o,location:I()}},di=function(e,r){return pe(e,r)},pi=function(e){return e.paren=!0,e},mi=function(e){return/^CURRENT_DATE$/i.test(e)?{type:"current-time",location:I(),mode:"date"}:/^CURRENT_TIMESTAMP$/i.test(e)?{type:"current-time",location:I(),mode:"timestamp"}:{type:"column-reference",location:I(),table:"",column:e}},vi=function(e){return{type:"column-reference",location:I(),table:"",column:e,delimited:!0}},hi=function(e){return e},wi=function(e,r){return e+r.join("")},Ii=function(e,r){return e+r.join("")},gi=function(e){return e},yi=function(e){return e.join("")},Ti=function(){return'"'},Ni=function(e){return{type:"parameter",location:I(),value:e[1]}},Si=function(e,r){return Z(I(),e,r)},Oi=function(e,r){return Z(I(),e,r)},xi=function(e){return{type:"function",location:I(),name:"extract",args:e}},Ci=function(e,r,o){return Z(I(),e,r,...o?[o]:[])},Mi=function(e,r,o){return Z(I(),e,r,o)},Ei=function(e){return{type:"function",location:I(),name:"substring",args:e}},Fi=function(e,r){return Z(I(),e,r)},$i=function(e,r){return Z(I(),e,r)},bi=function(e){return{type:"function",location:I(),name:"cast",args:e}},Ai=function(){return{type:"data-type",location:I(),value:{type:"integer"}}},Pi=function(){return{type:"data-type",location:I(),value:{type:"smallint"}}},Di=function(){return{type:"data-type",location:I(),value:{type:"float"}}},Li=function(){return{type:"data-type",location:I(),value:{type:"real"}}},Ri=function(){return{type:"data-type",location:I(),value:{type:"date"}}},_i=function(){return{type:"data-type",location:I(),value:{type:"timestamp"}}},Ui=function(){return{type:"data-type",location:I(),value:{type:"time"}}},Vi=function(e){return{type:"data-type",location:I(),value:{type:"varchar",size:parseInt(e)}}},Ji=function(e,r,o){return Z(I(),e,r,o)},Zi=function(e,r){return Z(I(),e,r)},zi=function(e){return{type:"function",location:I(),name:"trim",args:e}},ki=function(e){return{type:"string",location:I(),value:e??"BOTH"}},qi=function(e,r){return Z(I(),e,r)},Hi=function(e,r){return Z(I(),e,r)},Yi=function(e){return{type:"function",location:I(),name:"position",args:e}},ji=function(e,r){return{type:"function",location:I(),name:e,args:r}},Bi=function(e){return{type:"string",location:I(),value:e}},Qi=function(e){return e.type==="string"&&Js(e.value),{type:"timestamp",location:I(),value:e.value}},Wi=function(e){return e.type==="string"&&Zs(e.value),{type:"time",location:I(),value:e.value}},Gi=function(e,r,o){return{type:"interval",location:I(),value:r,qualifier:o,op:e}},Ki=function(e,r){return{type:"interval",location:I(),value:e,qualifier:r,op:""}},Xi=function(e,r){return{type:"interval-qualifier",location:I(),start:e,end:r}},eo=function(e,r){return{type:"interval-period",location:I(),period:e.value,precision:r,secondary:null}},to=function(e){return{type:"interval-period",location:I(),period:e.value,precision:null,secondary:null}},ro=function(e){return{type:"interval-period",location:I(),period:e.value,precision:null,secondary:null}},no=function(e,r){return{type:"interval-period",location:I(),period:"second",precision:e,secondary:r}},ao=function(e){return{type:"interval-period",location:I(),period:"second",precision:e,secondary:null}},io=function(){return{type:"interval-period",location:I(),period:"second",precision:null,secondary:null}},oo=function(e,r){return{type:"interval-period",location:I(),period:e.value,precision:r,secondary:null}},uo=function(e){return{type:"interval-period",location:I(),period:e.value,precision:null,secondary:null}},so=function(e,r){return{type:"interval-period",location:I(),period:"second",precision:e,secondary:r}},lo=function(e){return{type:"interval-period",location:I(),period:"second",precision:e,secondary:null}},co=function(){return{type:"interval-period",location:I(),period:"second",precision:null,secondary:null}},fo=function(){return{type:"string",location:I(),value:"day"}},po=function(){return{type:"string",location:I(),value:"hour"}},mo=function(){return{type:"string",location:I(),value:"minute"}},vo=function(){return{type:"string",location:I(),value:"month"}},ho=function(){return{type:"string",location:I(),value:"year"}},wo=function(e){return parseFloat(e)},Io=function(e){return parseFloat(e)},go=function(e){return e.type==="string"&&zs(e.value),{type:"date",location:I(),value:e.value}},yo=function(){return{type:"null",location:I(),value:null}},To=function(){return{type:"boolean",location:I(),value:!0}},No=function(){return{type:"boolean",location:I(),value:!1}},Tt=function(){return"'"},So=function(e){return{type:"string",location:I(),value:e.join("")}},Oo=function(e,r){return{type:"case-expression",location:I(),format:"simple",operand:e,clauses:r,else:null,elseLocation:null}},xo=function(e,r,o){return{type:"case-expression",location:I(),format:"simple",operand:e,clauses:r,else:o.value,elseLocation:o.location}},Co=function(e){return{type:"case-expression",location:I(),format:"searched",clauses:e,else:null,elseLocation:null}},Mo=function(e,r){return{type:"case-expression",location:I(),format:"searched",clauses:e,else:r.value,elseLocation:r.location}},Eo=function(e,r){return{type:"when-clause",location:I(),operand:e,value:r}},Fo=function(e,r){return{type:"when-clause",location:I(),operand:e,value:r}},$o=function(e){return{type:"else-clause",location:I(),value:e}},bo=function(e){return{type:"number",location:I(),value:e}},Ao=function(e,r,o){return parseFloat(e+r+o)},Po=function(e,r){return parseFloat(e+r)},Do=function(e,r){return parseFloat(e+r)},Lo=function(e){return parseFloat(e)},Ro=function(e,r){return e[0]+r},_o=function(e){return"."+(e??"")},Uo=function(e,r){return e+r},Vo=function(e){return e.join("")},Jo=function(e,r){return"e"+(r===null?"":r)},Zo=function(){return"IN"},zo=function(){return"IS"},ko=function(){return"LIKE"},qo=function(){return"ESCAPE"},Ho=function(){return"NOT"},Yo=function(){return"AND"},jo=function(){return"OR"},Bo=function(){return"BETWEEN"},Qo=function(){return"FROM"},Wo=function(){return"FOR"},Go=function(){return"SUBSTRING"},Ko=function(){return"EXTRACT"},Xo=function(){return"TRIM"},eu=function(){return"POSITION"},tu=function(){return"TIMESTAMP"},ru=function(){return"DATE"},nu=function(){return"TIME"},au=function(){return"LEADING"},iu=function(){return"TRAILING"},ou=function(){return"BOTH"},uu=function(){return"CAST"},su=function(){return"AS"},lu=function(){return"INTEGER"},cu=function(){return"SMALLINT"},fu=function(){return"FLOAT"},du=function(){return"REAL"},pu=function(){return"VARCHAR"},mu=function(){return"TO"},vu=function(){return"INTERVAL"},hu=function(){return"YEAR"},wu=function(){return"TIMEZONE_HOUR"},Iu=function(){return"TIMEZONE_MINUTE"},gu=function(){return"MONTH"},yu=function(){return"DAY"},Tu=function(){return"HOUR"},Nu=function(){return"MINUTE"},Su=function(){return"SECOND"},Ou=function(){return"CASE"},xu=function(){return"END"},Cu=function(){return"WHEN"},Mu=function(){return"THEN"},Eu=function(){return"ELSE"},Fu=function(e){return e},$u=function(e){return e.join("")},n=0|a.peg$currPos,f=n,se=[{line:1,column:1}],j=n,ge=a.peg$maxFailExpected||[],c=0|a.peg$silentFails;if(a.startRule){if(!(a.startRule in v))throw new Error(`Can't start parsing from rule "`+a.startRule+'".');g=v[a.startRule]}function I(){return ye(f,n)}function Re(e,r){throw Au(e,r=r!==void 0?r:ye(f,n))}function y(e,r){return{type:"literal",text:e,ignoreCase:r}}function q(e,r,o){return{type:"class",parts:e,inverted:r,ignoreCase:o}}function bu(){return{type:"end"}}function Nt(e){var r,o=se[e];if(o)return o;if(e>=se.length)r=se.length-1;else for(r=e;!se[--r];);for(o={line:(o=se[r]).line,column:o.column};r<e;)i.charCodeAt(r)===10?(o.line++,o.column=1):o.column++,r++;return se[e]=o,o}function ye(e,r,o){var s=Nt(e),h=Nt(r);return{source:l,start:{offset:e,line:s.line,column:s.column},end:{offset:r,line:h.line,column:h.column}}}function w(e){n<j||(n>j&&(j=n,ge=[]),ge.push(e))}function Au(e,r){return new ue(e,null,null,r)}function Pu(e,r,o){return new ue(ue.buildMessage(e,r),e,r,o)}function St(){var e,r;return e=n,p(),(r=M())!==t?(p(),f=e,e=Ya(r)):(n=e,e=t),e}function Ot(){var e,r,o,s,h,x;if(e=n,L()!==t){for(p(),r=[],o=M();o!==t;)r.push(o),o=n,s=n,h=p(),(x=K())!==t?s=h=[h,x,p()]:(n=s,s=t),s!==t&&(s=M())===t?(n=o,o=t):o=s;o=p(),(s=R())!==t?(f=e,e=ja(r)):(n=e,e=t)}else n=e,e=t;return e}function M(){var e,r,o,s,h,x;if(e=n,(r=_e())!==t){for(o=[],s=n,p(),(h=kt())!==t?(p(),(x=_e())!==t?(f=s,s=ht(r,h,x)):(n=s,s=t)):(n=s,s=t);s!==t;)o.push(s),s=n,p(),(h=kt())!==t?(p(),(x=_e())!==t?(f=s,s=ht(r,h,x)):(n=s,s=t)):(n=s,s=t);f=e,e=Ba(r,o)}else n=e,e=t;return e}function _e(){var e,r,o,s,h,x;if(e=n,(r=Te())!==t){for(o=[],s=n,p(),(h=Ee())!==t?(p(),(x=Te())!==t?(f=s,s=wt(r,h,x)):(n=s,s=t)):(n=s,s=t);s!==t;)o.push(s),s=n,p(),(h=Ee())!==t?(p(),(x=Te())!==t?(f=s,s=wt(r,h,x)):(n=s,s=t)):(n=s,s=t);f=e,e=Qa(r,o)}else n=e,e=t;return e}function Te(){var e,r,o,s,h;return e=n,(r=de())===t&&(r=n,i.charCodeAt(n)===33?(o=T,n++):(o=t,c===0&&w(Pn)),o!==t?(s=n,c++,i.charCodeAt(n)===61?(h=O,n++):(h=t,c===0&&w(Dn)),c--,h===t?s=void 0:(n=s,s=t),s!==t?r=o=[o,s]:(n=r,r=t)):(n=r,r=t)),r!==t?(o=p(),(s=Te())!==t?(f=e,e=Wa(s)):(n=e,e=t)):(n=e,e=t),e===t&&(e=Du()),e}function Du(){var e,r,o,s;return e=n,(r=G())!==t?(o=n,p(),(s=Lu())!==t?o=s:(n=o,o=t),o===t&&(o=null),f=e,e=Ga(r,o)):(n=e,e=t),e}function Lu(){var e;return(e=Ru())===t&&(e=Ju())===t&&(e=Uu())===t&&(e=_u())===t&&(e=Vu()),e}function Ru(){var e,r,o,s,h;if(e=n,r=[],o=n,p(),(s=xt())!==t?(p(),(h=G())!==t?(f=o,o=It(s,h)):(n=o,o=t)):(n=o,o=t),o!==t)for(;o!==t;)r.push(o),o=n,p(),(s=xt())!==t?(p(),(h=G())!==t?(f=o,o=It(s,h)):(n=o,o=t)):(n=o,o=t);else r=t;return r!==t&&(f=e,r=Ka(r)),e=r}function xt(){var e;return i.substr(n,2)===N?(e=N,n+=2):(e=t,c===0&&w(Ln)),e===t&&(i.charCodeAt(n)===62?(e=C,n++):(e=t,c===0&&w(Rn)),e===t&&(i.substr(n,2)===P?(e=P,n+=2):(e=t,c===0&&w(_n)),e===t&&(i.substr(n,2)===F?(e=F,n+=2):(e=t,c===0&&w(Un)),e===t&&(e=i.charAt(n),xn.test(e)?n++:(e=t,c===0&&w(Vn)),e===t&&(i.substr(n,2)===ee?(e=ee,n+=2):(e=t,c===0&&w(Jn))))))),e}function _u(){var e,r,o,s;return e=n,(r=Zt())!==t?(p(),(o=de())!==t?(p(),(s=G())!==t?(f=e,e=Xa(r,s)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,(r=Zt())!==t?(p(),(o=G())!==t?(f=e,e=ei(r,o)):(n=e,e=t)):(n=e,e=t)),e}function Uu(){var e,r,o,s,h,x,ie,ir;return e=n,(r=de())!==t?(p(),(o=qt())!==t?(s=p(),h=n,(x=G())!==t?(p(),(ie=Ee())!==t?(p(),(ir=G())!==t?(f=h,h=ti(o,x,ir)):(n=h,h=t)):(n=h,h=t)):(n=h,h=t),h!==t?(f=e,e=ri(o,h)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,(r=qt())!==t?(p(),o=n,(s=G())!==t?(h=p(),(x=Ee())!==t?(p(),(ie=G())!==t?(f=o,o=ni(r,s,ie)):(n=o,o=t)):(n=o,o=t)):(n=o,o=t),o!==t?(f=e,e=ai(r,o)):(n=e,e=t)):(n=e,e=t)),e}function Ct(){var e,r,o,s,h;return e=n,r=n,(o=de())!==t?(s=p(),(h=zt())!==t?r=o=[o,s,h]:(n=r,r=t)):(n=r,r=t),r!==t&&(f=e,r=ii(r)),(e=r)===t&&(e=zt()),e}function Mt(){var e,r,o,s,h;return e=n,r=n,(o=de())!==t?(s=p(),(h=ke())!==t?r=o=[o,s,h]:(n=r,r=t)):(n=r,r=t),r!==t&&(f=e,r=oi(r)),(e=r)===t&&(e=ke()),e}function Vu(){var e,r,o,s;return e=n,(r=Ct())!==t?(p(),(o=re())!==t?(p(),gs()!==t?(p(),(s=ze())!==t?(f=e,e=ui(r,o,s)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,(r=Ct())!==t?(p(),(o=re())!==t?(f=e,e=si(r,o)):(n=e,e=t)):(n=e,e=t)),e}function Ju(){var e,r,o;return e=n,(r=Mt())!==t?(p(),(o=Ot())!==t?(f=e,e=li(r,o)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,(r=Mt())!==t?(p(),(o=Ze())!==t?(f=e,e=ci(r,o)):(n=e,e=t)):(n=e,e=t)),e}function G(){var e,r,o,s,h,x;if(e=n,(r=Ue())!==t){for(o=[],s=n,p(),(h=Et())!==t?(p(),(x=Ue())!==t?(f=s,s=gt(r,h,x)):(n=s,s=t)):(n=s,s=t);s!==t;)o.push(s),s=n,p(),(h=Et())!==t?(p(),(x=Ue())!==t?(f=s,s=gt(r,h,x)):(n=s,s=t)):(n=s,s=t);f=e,e=fi(r,o)}else n=e,e=t;return e}function Et(){var e;return e=i.charAt(n),we.test(e)?n++:(e=t,c===0&&w(Ie)),e===t&&(i.substr(n,2)===te?(e=te,n+=2):(e=t,c===0&&w(Zn))),e}function Ue(){var e,r,o,s,h,x;if(e=n,(r=Ve())!==t){for(o=[],s=n,p(),(h=Ft())!==t?(p(),(x=Ve())!==t?(f=s,s=yt(r,h,x)):(n=s,s=t)):(n=s,s=t);s!==t;)o.push(s),s=n,p(),(h=Ft())!==t?(p(),(x=Ve())!==t?(f=s,s=yt(r,h,x)):(n=s,s=t)):(n=s,s=t);f=e,e=di(r,o)}else n=e,e=t;return e}function Ft(){var e;return e=i.charAt(n),Cn.test(e)?n++:(e=t,c===0&&w(zn)),e}function Ve(){var e,r;return(e=es())===t&&(e=Bu())===t&&(e=Qu())===t&&(e=Gu())===t&&(e=Ku())===t&&(e=Wu())===t&&(e=Xu())===t&&(e=cs())===t&&(e=Zu())===t&&(e=Ze())===t&&(e=n,L()!==t?(p(),(r=M())!==t?(p(),R()!==t?(f=e,e=pi(r)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)),e}function Zu(){var e,r;return e=n,(r=zu())!==t&&(f=e,r=mi(r)),(e=r)===t&&(e=n,(r=qu())!==t&&(f=e,r=vi(r)),e=r),e}function zu(){var e,r;return e=n,(r=ku())!==t&&(f=e,r=hi(r)),e=r}function ku(){var e,r,o,s;if(e=n,(r=Je())!==t){for(o=[],s=bt();s!==t;)o.push(s),s=bt();f=e,e=wi(r,o)}else n=e,e=t;return e}function $t(){var e,r,o,s;if(e=n,(r=Je())!==t){for(o=[],s=S();s!==t;)o.push(s),s=S();f=e,e=Ii(r,o)}else n=e,e=t;return e}function Je(){var e;return e=i.charAt(n),Mn.test(e)?n++:(e=t,c===0&&w(kn)),e}function S(){var e;return e=i.charAt(n),En.test(e)?n++:(e=t,c===0&&w(qn)),e}function bt(){var e;return e=i.charAt(n),ut.test(e)?n++:(e=t,c===0&&w(ct)),e}function qu(){var e,r;return e=n,Ne()!==t?(r=Hu(),Ne()!==t?(f=e,e=gi(r)):(n=e,e=t)):(n=e,e=t),e}function Hu(){var e,r,o;for(e=n,r=[],o=At();o!==t;)r.push(o),o=At();return f=e,e=r=yi(r)}function At(){var e;return(e=ju())===t&&(e=Yu()),e}function Yu(){var e;return e=n,Ne()!==t&&Ne()!==t?(f=e,e=Ti()):(n=e,e=t),e}function ju(){var e;return e=i.charAt(n),ut.test(e)?n++:(e=t,c===0&&w(ct)),e}function Ne(){var e;return e=i.charAt(n),Fn.test(e)?n++:(e=t,c===0&&w(Hn)),e}function Ze(){var e,r,o,s;return e=n,r=n,i.charCodeAt(n)===64?(o=Er,n++):(o=t,c===0&&w(Yn)),o!==t&&(s=$t())!==t?r=o=[o,s]:(n=r,r=t),r!==t&&(f=e,r=Ni(r)),e=r}function Bu(){var e,r,o,s;return e=n,Ht()!==t?(p(),r=n,L()!==t?(p(),(o=Lt())!==t?(p(),qe()!==t?(p(),(s=M())!==t?(p(),R()!==t?(f=r,r=Si(o,s)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t),r===t&&(r=n,L()!==t?(p(),(o=Lt())!==t?(p(),K()!==t?(p(),(s=M())!==t?(p(),R()!==t?(f=r,r=Oi(o,s)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)),r!==t?(f=e,e=xi(r)):(n=e,e=t)):(n=e,e=t),e}function Qu(){var e,r,o,s,h,x,ie;return e=n,Ts()!==t?(p(),r=n,L()!==t?(p(),(o=M())!==t?(p(),qe()!==t?(p(),(s=M())!==t?(p(),h=n,ys()!==t?(x=p(),(ie=M())!==t?(p(),h=ie):(n=h,h=t)):(n=h,h=t),h===t&&(h=null),R()!==t?(f=r,r=Ci(o,s,h)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t),r===t&&(r=n,L()!==t?(p(),(o=M())!==t?(p(),K()!==t?(p(),(s=M())!==t?(p(),(h=K())!==t?(p(),(x=M())!==t&&(ie=R())!==t?(f=r,r=Mi(o,s,x)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)),r!==t?(f=e,e=Ei(r)):(n=e,e=t)):(n=e,e=t),e}function Wu(){var e,r,o,s;return e=n,Ms()!==t?(p(),r=n,L()!==t?(p(),(o=M())!==t?(p(),Es()!==t?(p(),(s=Pt())!==t?(p(),R()!==t?(f=r,r=Fi(o,s)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t),r===t&&(r=n,L()!==t?(p(),(o=M())!==t?(p(),K()!==t?(p(),(s=Pt())!==t?(p(),R()!==t?(f=r,r=$i(o,s)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)),r!==t?(f=e,e=bi(r)):(n=e,e=t)):(n=e,e=t),e}function Pt(){var e,r,o;return e=n,(r=Fs())!==t&&(f=e,r=Ai()),(e=r)===t&&(e=n,(r=$s())!==t&&(f=e,r=Pi()),(e=r)===t&&(e=n,(r=bs())!==t&&(f=e,r=Di()),(e=r)===t&&(e=n,(r=As())!==t&&(f=e,r=Li()),(e=r)===t&&(e=n,(r=jt())!==t&&(f=e,r=Ri()),(e=r)===t&&(e=n,(r=Yt())!==t&&(f=e,r=_i()),(e=r)===t&&(e=n,(r=Bt())!==t&&(f=e,r=Ui()),(e=r)===t&&(e=n,(r=Ps())!==t?(p(),L()!==t?(p(),(o=ne())!==t?(p(),R()!==t?(f=e,e=Vi(o)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)))))))),e}function Gu(){var e,r,o,s,h;return e=n,Ns()!==t?(p(),r=n,L()!==t?(p(),o=Dt(),p(),(s=M())!==t?(p(),qe()!==t?(p(),(h=M())!==t?(p(),R()!==t?(f=r,r=Ji(o,s,h)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t),r===t&&(r=n,L()!==t?(p(),o=Dt(),p(),(s=M())!==t?(p(),R()!==t?(f=r,r=Zi(o,s)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)),r!==t?(f=e,e=zi(r)):(n=e,e=t)):(n=e,e=t),e}function Dt(){var e,r;return e=n,(r=Os())===t&&(r=xs())===t&&(r=Cs()),r===t&&(r=null),f=e,e=r=ki(r)}function Ku(){var e,r,o,s;return e=n,Ss()!==t?(p(),r=n,L()!==t?(p(),(o=M())!==t?(p(),ke()!==t?(p(),(s=M())!==t?(p(),R()!==t?(f=r,r=qi(o,s)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t),r===t&&(r=n,L()!==t?(p(),(o=M())!==t?(p(),K()!==t?(p(),(s=M())!==t?(p(),R()!==t?(f=r,r=Hi(o,s)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)),r!==t?(f=e,e=Yi(r)):(n=e,e=t)):(n=e,e=t),e}function Xu(){var e,r,o,s;return e=n,r=n,c++,o=Ht(),c--,o===t?r=void 0:(n=r,r=t),r!==t&&(o=Us())!==t?(p(),(s=Ot())!==t?(f=e,e=ji(o,s)):(n=e,e=t)):(n=e,e=t),e}function Lt(){var e,r;return e=n,(r=Wt())===t&&(r=Gt())===t&&(r=Kt())===t&&(r=Xt())===t&&(r=er())===t&&(r=ae())===t&&(r=Ls())===t&&(r=Rs()),r!==t&&(f=e,r=Bi(r)),e=r}function es(){var e;return(e=ze())===t&&(e=ps())===t&&(e=ls())===t&&(e=ss())===t&&(e=us())===t&&(e=ts())===t&&(e=ns())===t&&(e=rs()),e}function ts(){var e,r;return e=n,Yt()!==t?(p(),(r=re())!==t?(f=e,e=Qi(r)):(n=e,e=t)):(n=e,e=t),e}function rs(){var e,r;return e=n,Bt()!==t?(p(),(r=re())!==t?(f=e,e=Wi(r)):(n=e,e=t)):(n=e,e=t),e}function ns(){var e,r,o,s;return e=n,Qt()!==t?(p(),r=i.charAt(n),we.test(r)?n++:(r=t,c===0&&w(Ie)),r!==t?(p(),(o=re())!==t?(p(),(s=Rt())!==t?(f=e,e=Gi(r,o,s)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,Qt()!==t?(p(),(r=re())!==t?(p(),(o=Rt())!==t?(f=e,e=Ki(r,o)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)),e}function Rt(){var e,r,o;return e=n,(r=as())!==t?(p(),Ds()!==t?(p(),(o=is())!==t?(f=e,e=Xi(r,o)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=os()),e}function as(){var e,r,o;return e=n,(r=fe())!==t?(p(),L()!==t?(p(),(o=Oe())!==t?(p(),R()!==t?(f=e,e=eo(r,o)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,(r=fe())!==t&&(f=e,r=to(r)),e=r),e}function is(){var e,r,o,s;return e=n,(r=fe())!==t&&(f=e,r=ro(r)),(e=r)===t&&(e=n,(r=ae())!==t?(p(),L()!==t?(p(),(o=Oe())!==t?(p(),K()!==t?(p(),(s=Se())!==t?(p(),R()!==t?(f=e,e=no(o,s)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,(r=ae())!==t?(p(),L()!==t?(p(),(o=Oe())!==t?(p(),R()!==t?(f=e,e=ao(o)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,(r=ae())!==t&&(f=e,r=io()),e=r))),e}function os(){var e,r,o,s;return e=n,(r=fe())!==t?(p(),L()!==t?(p(),(o=Se())!==t?(p(),R()!==t?(f=e,e=oo(r,o)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,(r=fe())!==t&&(f=e,r=uo(r)),(e=r)===t&&(e=n,(r=ae())!==t?(p(),L()!==t?(p(),(o=Oe())!==t?(p(),K()!==t?(p(),(s=Se())!==t?(p(),R()!==t?(f=e,e=so(o,s)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,(r=ae())!==t?(p(),L()!==t?(p(),(o=Se())!==t?(p(),R()!==t?(f=e,e=lo(o)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,(r=ae())!==t&&(f=e,r=co()),e=r)))),e}function fe(){var e,r;return e=n,(r=Kt())!==t&&(f=e,r=fo()),(e=r)===t&&(e=n,(r=Xt())!==t&&(f=e,r=po()),(e=r)===t&&(e=n,(r=er())!==t&&(f=e,r=mo()),(e=r)===t&&(e=n,(r=Gt())!==t&&(f=e,r=vo()),(e=r)===t&&(e=n,(r=Wt())!==t&&(f=e,r=ho()),e=r)))),e}function Se(){var e,r;return e=n,(r=ne())!==t&&(f=e,r=wo(r)),e=r}function Oe(){var e,r;return e=n,(r=ne())!==t&&(f=e,r=Io(r)),e=r}function us(){var e,r;return e=n,jt()!==t?(p(),(r=re())!==t?(f=e,e=go(r)):(n=e,e=t)):(n=e,e=t),e}function ss(){var e,r;return e=n,(r=hs())!==t&&(f=e,r=yo()),e=r}function ls(){var e,r;return e=n,(r=ws())!==t&&(f=e,r=To()),(e=r)===t&&(e=n,(r=Is())!==t&&(f=e,r=No()),e=r),e}function re(){var e;return(e=ze())===t&&(e=Ze()),e}function ze(){var e,r,o,s,h;if(e=n,i.charCodeAt(n)===39?(r=at,n++):(r=t,c===0&&w(ft)),r===t&&(i.substr(n,2)===it?(r=it,n+=2):(r=t,c===0&&w(jn))),r!==t){for(o=[],s=n,i.substr(n,2)===he?(h=he,n+=2):(h=t,c===0&&w(dt)),h!==t&&(f=s,h=Tt()),(s=h)===t&&(s=i.charAt(n),st.test(s)?n++:(s=t,c===0&&w(pt)));s!==t;)o.push(s),s=n,i.substr(n,2)===he?(h=he,n+=2):(h=t,c===0&&w(dt)),h!==t&&(f=s,h=Tt()),(s=h)===t&&(s=i.charAt(n),st.test(s)?n++:(s=t,c===0&&w(pt)));i.charCodeAt(n)===39?(s=at,n++):(s=t,c===0&&w(ft)),s!==t?(f=e,e=So(o)):(n=e,e=t)}else n=e,e=t;return e}function cs(){var e;return(e=fs())===t&&(e=ds()),e}function fs(){var e,r,o,s,h;if(e=n,Fe()!==t)if(p(),(r=M())!==t){for(p(),o=[],s=n,(h=Ce())!==t?(p(),s=h):(n=s,s=t);s!==t;)o.push(s),s=n,(h=Ce())!==t?(p(),s=h):(n=s,s=t);(s=$e())!==t?(f=e,e=Oo(r,o)):(n=e,e=t)}else n=e,e=t;else n=e,e=t;if(e===t)if(e=n,Fe()!==t)if(p(),(r=M())!==t){for(p(),o=[],s=n,(h=Ce())!==t?(p(),s=h):(n=s,s=t);s!==t;)o.push(s),s=n,(h=Ce())!==t?(p(),s=h):(n=s,s=t);(s=_t())!==t?(h=p(),$e()!==t?(f=e,e=xo(r,o,s)):(n=e,e=t)):(n=e,e=t)}else n=e,e=t;else n=e,e=t;return e}function ds(){var e,r,o,s;if(e=n,Fe()!==t){for(p(),r=[],o=n,(s=xe())!==t?(p(),o=s):(n=o,o=t);o!==t;)r.push(o),o=n,(s=xe())!==t?(p(),o=s):(n=o,o=t);(o=$e())!==t?(f=e,e=Co(r)):(n=e,e=t)}else n=e,e=t;if(e===t)if(e=n,Fe()!==t){for(p(),r=[],o=n,(s=xe())!==t?(p(),o=s):(n=o,o=t);o!==t;)r.push(o),o=n,(s=xe())!==t?(p(),o=s):(n=o,o=t);(o=_t())!==t?(s=p(),$e()!==t?(f=e,e=Mo(r,o)):(n=e,e=t)):(n=e,e=t)}else n=e,e=t;return e}function xe(){var e,r,o;return e=n,tr()!==t?(p(),(r=M())!==t?(p(),rr()!==t?(p(),(o=M())!==t?(f=e,e=Eo(r,o)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e}function Ce(){var e,r,o;return e=n,tr()!==t?(p(),(r=M())!==t?(p(),rr()!==t?(p(),(o=M())!==t?(f=e,e=Fo(r,o)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e}function _t(){var e,r;return e=n,_s()!==t?(p(),(r=M())!==t?(f=e,e=$o(r)):(n=e,e=t)):(n=e,e=t),e}function ps(){var e,r,o,s;return e=n,(r=ms())!==t?(o=n,c++,s=Je(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(f=e,e=bo(r)):(n=e,e=t)):(n=e,e=t),e}function ms(){var e,r,o,s;return e=n,(r=Me())!==t&&(o=Ut())!==t&&(s=Vt())!==t?(f=e,e=Ao(r,o,s)):(n=e,e=t),e===t&&(e=n,(r=Me())!==t&&(o=Ut())!==t?(f=e,e=Po(r,o)):(n=e,e=t),e===t&&(e=n,(r=Me())!==t&&(o=Vt())!==t?(f=e,e=Do(r,o)):(n=e,e=t),e===t&&(e=n,(r=Me())!==t&&(f=e,r=Lo(r)),e=r))),e}function Me(){var e,r,o;return(e=ne())===t&&(e=n,r=i.charAt(n),we.test(r)?n++:(r=t,c===0&&w(Ie)),r!==t&&(o=ne())!==t?(f=e,e=Ro(r,o)):(n=e,e=t)),e}function Ut(){var e,r,o;return e=n,i.charCodeAt(n)===46?(r=Fr,n++):(r=t,c===0&&w(Bn)),r!==t?((o=ne())===t&&(o=null),f=e,e=_o(o)):(n=e,e=t),e}function Vt(){var e,r,o;return e=n,(r=vs())!==t&&(o=ne())!==t?(f=e,e=Uo(r,o)):(n=e,e=t),e}function ne(){var e,r,o;if(e=n,r=[],(o=Jt())!==t)for(;o!==t;)r.push(o),o=Jt();else r=t;return r!==t&&(f=e,r=Vo(r)),e=r}function Jt(){var e;return e=i.charAt(n),$n.test(e)?n++:(e=t,c===0&&w(Qn)),e}function vs(){var e,r,o;return e=n,r=i.charAt(n),bn.test(r)?n++:(r=t,c===0&&w(Wn)),r!==t?(o=i.charAt(n),we.test(o)?n++:(o=t,c===0&&w(Ie)),o===t&&(o=null),f=e,e=Jo(r,o)):(n=e,e=t),e}function hs(){var e,r,o,s;return e=n,(r=i.substr(n,4)).toLowerCase()===$r?n+=4:(r=t,c===0&&w(Gn)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?e=r=[r,o]:(n=e,e=t)):(n=e,e=t),e}function ws(){var e,r,o,s;return e=n,(r=i.substr(n,4)).toLowerCase()===br?n+=4:(r=t,c===0&&w(Kn)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?e=r=[r,o]:(n=e,e=t)):(n=e,e=t),e}function Is(){var e,r,o,s;return e=n,(r=i.substr(n,5)).toLowerCase()===Ar?n+=5:(r=t,c===0&&w(Xn)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?e=r=[r,o]:(n=e,e=t)):(n=e,e=t),e}function ke(){var e,r,o,s;return e=n,(r=i.substr(n,2)).toLowerCase()===Pr?n+=2:(r=t,c===0&&w(ea)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(f=e,e=Zo()):(n=e,e=t)):(n=e,e=t),e}function Zt(){var e,r,o,s;return e=n,(r=i.substr(n,2)).toLowerCase()===Dr?n+=2:(r=t,c===0&&w(ta)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(f=e,e=zo()):(n=e,e=t)):(n=e,e=t),e}function zt(){var e,r,o,s;return e=n,(r=i.substr(n,4)).toLowerCase()===Lr?n+=4:(r=t,c===0&&w(ra)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(f=e,e=ko()):(n=e,e=t)):(n=e,e=t),e}function gs(){var e,r,o,s;return e=n,(r=i.substr(n,6)).toLowerCase()===Rr?n+=6:(r=t,c===0&&w(na)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(f=e,e=qo()):(n=e,e=t)):(n=e,e=t),e}function de(){var e,r,o,s;return e=n,(r=i.substr(n,3)).toLowerCase()===_r?n+=3:(r=t,c===0&&w(aa)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(f=e,e=Ho()):(n=e,e=t)):(n=e,e=t),e}function Ee(){var e,r,o,s;return e=n,(r=i.substr(n,3)).toLowerCase()===Ur?n+=3:(r=t,c===0&&w(ia)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(f=e,e=Yo()):(n=e,e=t)):(n=e,e=t),e}function kt(){var e,r,o,s;return e=n,(r=i.substr(n,2)).toLowerCase()===Vr?n+=2:(r=t,c===0&&w(oa)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(f=e,e=jo()):(n=e,e=t)):(n=e,e=t),e}function qt(){var e,r,o,s;return e=n,(r=i.substr(n,7)).toLowerCase()===Jr?n+=7:(r=t,c===0&&w(ua)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(f=e,e=Bo()):(n=e,e=t)):(n=e,e=t),e}function qe(){var e,r,o,s;return e=n,(r=i.substr(n,4)).toLowerCase()===Zr?n+=4:(r=t,c===0&&w(sa)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(f=e,e=Qo()):(n=e,e=t)):(n=e,e=t),e}function ys(){var e,r,o,s;return e=n,(r=i.substr(n,3)).toLowerCase()===zr?n+=3:(r=t,c===0&&w(la)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(f=e,e=Wo()):(n=e,e=t)):(n=e,e=t),e}function Ts(){var e,r,o,s;return e=n,(r=i.substr(n,9)).toLowerCase()===kr?n+=9:(r=t,c===0&&w(ca)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(f=e,e=Go()):(n=e,e=t)):(n=e,e=t),e}function Ht(){var e,r,o,s;return e=n,(r=i.substr(n,7)).toLowerCase()===qr?n+=7:(r=t,c===0&&w(fa)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(f=e,e=Ko()):(n=e,e=t)):(n=e,e=t),e}function Ns(){var e,r,o,s;return e=n,(r=i.substr(n,4)).toLowerCase()===Hr?n+=4:(r=t,c===0&&w(da)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(f=e,e=Xo()):(n=e,e=t)):(n=e,e=t),e}function Ss(){var e,r,o,s;return e=n,(r=i.substr(n,8)).toLowerCase()===Yr?n+=8:(r=t,c===0&&w(pa)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(f=e,e=eu()):(n=e,e=t)):(n=e,e=t),e}function Yt(){var e,r,o,s;return e=n,(r=i.substr(n,9)).toLowerCase()===jr?n+=9:(r=t,c===0&&w(ma)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(f=e,e=tu()):(n=e,e=t)):(n=e,e=t),e}function jt(){var e,r,o,s;return e=n,(r=i.substr(n,4)).toLowerCase()===Br?n+=4:(r=t,c===0&&w(va)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(f=e,e=ru()):(n=e,e=t)):(n=e,e=t),e}function Bt(){var e,r,o,s;return e=n,(r=i.substr(n,4)).toLowerCase()===Qr?n+=4:(r=t,c===0&&w(ha)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(f=e,e=nu()):(n=e,e=t)):(n=e,e=t),e}function Os(){var e,r,o,s;return e=n,(r=i.substr(n,7)).toLowerCase()===Wr?n+=7:(r=t,c===0&&w(wa)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(f=e,e=au()):(n=e,e=t)):(n=e,e=t),e}function xs(){var e,r,o,s;return e=n,(r=i.substr(n,8)).toLowerCase()===Gr?n+=8:(r=t,c===0&&w(Ia)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(f=e,e=iu()):(n=e,e=t)):(n=e,e=t),e}function Cs(){var e,r,o,s;return e=n,(r=i.substr(n,4)).toLowerCase()===Kr?n+=4:(r=t,c===0&&w(ga)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(f=e,e=ou()):(n=e,e=t)):(n=e,e=t),e}function Ms(){var e,r,o,s;return e=n,(r=i.substr(n,4)).toLowerCase()===Xr?n+=4:(r=t,c===0&&w(ya)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(f=e,e=uu()):(n=e,e=t)):(n=e,e=t),e}function Es(){var e,r,o,s;return e=n,(r=i.substr(n,2)).toLowerCase()===en?n+=2:(r=t,c===0&&w(Ta)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(f=e,e=su()):(n=e,e=t)):(n=e,e=t),e}function Fs(){var e,r,o,s;return e=n,(r=i.substr(n,7)).toLowerCase()===tn?n+=7:(r=t,c===0&&w(Na)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(f=e,e=lu()):(n=e,e=t)):(n=e,e=t),e}function $s(){var e,r,o,s;return e=n,(r=i.substr(n,8)).toLowerCase()===rn?n+=8:(r=t,c===0&&w(Sa)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(f=e,e=cu()):(n=e,e=t)):(n=e,e=t),e}function bs(){var e,r,o,s;return e=n,(r=i.substr(n,5)).toLowerCase()===nn?n+=5:(r=t,c===0&&w(Oa)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(f=e,e=fu()):(n=e,e=t)):(n=e,e=t),e}function As(){var e,r,o,s;return e=n,(r=i.substr(n,4)).toLowerCase()===an?n+=4:(r=t,c===0&&w(xa)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(f=e,e=du()):(n=e,e=t)):(n=e,e=t),e}function Ps(){var e,r,o,s;return e=n,(r=i.substr(n,7)).toLowerCase()===on?n+=7:(r=t,c===0&&w(Ca)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(f=e,e=pu()):(n=e,e=t)):(n=e,e=t),e}function Ds(){var e,r,o,s;return e=n,(r=i.substr(n,2)).toLowerCase()===un?n+=2:(r=t,c===0&&w(Ma)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(f=e,e=mu()):(n=e,e=t)):(n=e,e=t),e}function Qt(){var e,r,o,s;return e=n,(r=i.substr(n,8)).toLowerCase()===sn?n+=8:(r=t,c===0&&w(Ea)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(f=e,e=vu()):(n=e,e=t)):(n=e,e=t),e}function Wt(){var e,r,o,s;return e=n,(r=i.substr(n,4)).toLowerCase()===ln?n+=4:(r=t,c===0&&w(Fa)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(f=e,e=hu()):(n=e,e=t)):(n=e,e=t),e}function Ls(){var e,r,o,s;return e=n,(r=i.substr(n,13)).toLowerCase()===cn?n+=13:(r=t,c===0&&w($a)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(f=e,e=wu()):(n=e,e=t)):(n=e,e=t),e}function Rs(){var e,r,o,s;return e=n,(r=i.substr(n,15)).toLowerCase()===fn?n+=15:(r=t,c===0&&w(ba)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(f=e,e=Iu()):(n=e,e=t)):(n=e,e=t),e}function Gt(){var e,r,o,s;return e=n,(r=i.substr(n,5)).toLowerCase()===dn?n+=5:(r=t,c===0&&w(Aa)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(f=e,e=gu()):(n=e,e=t)):(n=e,e=t),e}function Kt(){var e,r,o,s;return e=n,(r=i.substr(n,3)).toLowerCase()===pn?n+=3:(r=t,c===0&&w(Pa)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(f=e,e=yu()):(n=e,e=t)):(n=e,e=t),e}function Xt(){var e,r,o,s;return e=n,(r=i.substr(n,4)).toLowerCase()===mn?n+=4:(r=t,c===0&&w(Da)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(f=e,e=Tu()):(n=e,e=t)):(n=e,e=t),e}function er(){var e,r,o,s;return e=n,(r=i.substr(n,6)).toLowerCase()===vn?n+=6:(r=t,c===0&&w(La)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(f=e,e=Nu()):(n=e,e=t)):(n=e,e=t),e}function ae(){var e,r,o,s;return e=n,(r=i.substr(n,6)).toLowerCase()===hn?n+=6:(r=t,c===0&&w(Ra)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(f=e,e=Su()):(n=e,e=t)):(n=e,e=t),e}function Fe(){var e,r,o,s;return e=n,(r=i.substr(n,4)).toLowerCase()===wn?n+=4:(r=t,c===0&&w(_a)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(f=e,e=Ou()):(n=e,e=t)):(n=e,e=t),e}function $e(){var e,r,o,s;return e=n,(r=i.substr(n,3)).toLowerCase()===In?n+=3:(r=t,c===0&&w(Ua)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(f=e,e=xu()):(n=e,e=t)):(n=e,e=t),e}function tr(){var e,r,o,s;return e=n,(r=i.substr(n,4)).toLowerCase()===gn?n+=4:(r=t,c===0&&w(Va)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(f=e,e=Cu()):(n=e,e=t)):(n=e,e=t),e}function rr(){var e,r,o,s;return e=n,(r=i.substr(n,4)).toLowerCase()===yn?n+=4:(r=t,c===0&&w(Ja)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(f=e,e=Mu()):(n=e,e=t)):(n=e,e=t),e}function _s(){var e,r,o,s;return e=n,(r=i.substr(n,4)).toLowerCase()===Tn?n+=4:(r=t,c===0&&w(Za)),r!==t?(o=n,c++,s=S(),c--,s===t?o=void 0:(n=o,o=t),o!==t?(f=e,e=Eu()):(n=e,e=t)):(n=e,e=t),e}function K(){var e;return i.charCodeAt(n)===44?(e=Nn,n++):(e=t,c===0&&w(za)),e}function L(){var e;return i.charCodeAt(n)===40?(e=Sn,n++):(e=t,c===0&&w(ka)),e}function R(){var e;return i.charCodeAt(n)===41?(e=On,n++):(e=t,c===0&&w(qa)),e}function p(){var e,r;for(e=[],r=nr();r!==t;)e.push(r),r=nr();return e}function nr(){var e;return e=i.charAt(n),An.test(e)?n++:(e=t,c===0&&w(Ha)),e}function Us(){var e,r,o,s;if(e=n,(r=$t())!==t&&(f=e,r=Fu(r)),(e=r)===t)if(e=n,i.charCodeAt(n)===96?(r=ot,n++):(r=t,c===0&&w(mt)),r!==t){if(o=[],s=i.charAt(n),lt.test(s)?n++:(s=t,c===0&&w(vt)),s!==t)for(;s!==t;)o.push(s),s=i.charAt(n),lt.test(s)?n++:(s=t,c===0&&w(vt));else o=t;o!==t?(i.charCodeAt(n)===96?(s=ot,n++):(s=t,c===0&&w(mt)),s!==t?(f=e,e=$u(o)):(n=e,e=t)):(n=e,e=t)}else n=e,e=t;return e}function Vs(e,r,o){return{type:"unary-expression",location:o,operator:e,expr:r}}function ar(e,r,o,s,h){const x={type:"binary-expression",location:h,operator:e,left:r,right:o};return s!==void 0&&(x.escape=s),x}function Z(e,...r){return{type:"expression-list",location:e,value:r}}function pe(e,r){let o=e;for(const{op:s,expr:h,location:{end:x}}of r)o=ar(s,o,h,void 0,{...o.location,end:x});return o}function Js(e){/^(\d{4})-(\d{1,2})-(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/.test(e)!==!0&&Re("Timestamp literal is invalid")}function Zs(e){/^(\d{1,2}):(\d{1,2}):(\d{1,2})$|^(\d{1,2}):(\d{1,2})$|^(\d{1,2}):(\d{1,2}):(\d{1,2}).([0-9]+)$/.test(e)!==!0&&Re("Time literal is invalid")}function zs(e){/^(\d{4})-(\d{1,2})-(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/.test(e)!==!0&&Re("Date literal is invalid")}if(u=g(),a.peg$library)return{peg$result:u,peg$currPos:n,peg$FAILED:t,peg$maxFailExpected:ge,peg$maxFailPos:j};if(u!==t&&n===i.length)return u;throw u!==t&&n<i.length&&w(bu()),Pu(ge,j<i.length?i.charAt(j):null,j<i.length?ye(j,j+1):ye(j,j))}vc(ue,Error),ue.prototype.format=function(i){var a="Error: "+this.message;if(this.location){var u,t=null;for(u=0;u<i.length;u++)if(i[u].source===this.location.source){t=i[u].text.split(/\r\n|\n|\r/g);break}var l=this.location.start,v=this.location.source&&typeof this.location.source.offset=="function"?this.location.source.offset(l):l,g=this.location.source+":"+v.line+":"+v.column;if(t){var T=this.location.end,O=Qe("",v.line.toString().length," "),N=t[l.line-1],C=(l.line===T.line?T.column:N.length+1)-l.column||1;a+=`
 --> `+g+`
`+O+` |
`+v.line+" | "+N+`
`+O+" | "+Qe("",l.column-1," ")+Qe("",C,"^")}else a+=`
 at `+g}return a},ue.buildMessage=function(i,a){var u={literal:function(N){return'"'+l(N.text)+'"'},class:function(N){var C=N.parts.map(function(P){return Array.isArray(P)?v(P[0])+"-"+v(P[1]):v(P)});return"["+(N.inverted?"^":"")+C.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(N){return N.description}};function t(N){return N.charCodeAt(0).toString(16).toUpperCase()}function l(N){return N.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(C){return"\\x0"+t(C)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(C){return"\\x"+t(C)})}function v(N){return N.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(C){return"\\x0"+t(C)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(C){return"\\x"+t(C)})}function g(N){return u[N.type](N)}function T(N){var C,P,F=N.map(g);if(F.sort(),F.length>0){for(C=1,P=1;C<F.length;C++)F[C-1]!==F[C]&&(F[P]=F[C],P++);F.length=P}switch(F.length){case 1:return F[0];case 2:return F[0]+" or "+F[1];default:return F.slice(0,-1).join(", ")+", or "+F[F.length-1]}}function O(N){return N?'"'+l(N)+'"':"end of input"}return"Expected "+T(i)+" but "+O(a)+" found."};class wc{static parse(a){return hc(a)}}function _(i,a){if(i!=null)switch(a(i),i.type){case"when-clause":_(i.operand,a),_(i.value,a);break;case"case-expression":for(const u of i.clauses)_(u,a);i.format==="simple"&&_(i.operand,a),i.else!==null&&_(i.else,a);break;case"expression-list":for(const u of i.value)_(u,a);break;case"unary-expression":_(i.expr,a);break;case"binary-expression":_(i.left,a),_(i.right,a);break;case"function":_(i.args,a);break;case"interval":_(i.value,a),_(i.qualifier,a);break;case"interval-qualifier":_(i.start,a),_(i.end,a)}}const Ic=new Set(["current_timestamp","current_date","current_time"]);class gc{static makeBool(a){return Or(a)}static featureValue(a,u,t,l){return Mr(a,u,t,l)}static equalsNull(a){return a===null}static applyLike(a,u,t){return Xe(a,u,t)}static ensureArray(a){return Ge(a)}static applyIn(a,u,t){return Ke(a,u)}static currentDate(a){return k.fromNow(a)}static makeSqlInterval(a,u,t){return E.createFromValueAndQualifier(a,u,t)}static convertInterval(a){return a instanceof E?a.valueInMilliseconds():a}static currentTimestamp(a){return Pe(new Date,a)}static compare(a,u,t,l){return z(u,t,a)}static calculate(a,u,t,l){return Nr(a,u,t,l)}static evaluateTime(a){return tt(a)}static evaluateTimestamp(a,u,t){return De(a,u,t)}static evaluateDate(a,u){return gr(a,u)}static evaluateFunction(a,u,t){return rt(a,u,t)}static lookup(a,u){const t=u[a];return t===void 0?null:t}static between(a,u,t){return a==null||u[0]==null||u[1]==null?null:z(a,u[0],">=")&&z(a,u[1],"<=")}static notbetween(a,u,t){return a==null||u[0]==null||u[1]==null?null:z(a,u[0],"<")||z(a,u[1],">")}static ternaryNot(a){return Ae(a)}static ternaryAnd(a,u){return xr(a,u)}static ternaryOr(a,u){return Cr(a,u)}}let yc=class Sr{constructor(a,u,t="UTC"){this.fieldsIndex=u,this.timeZone=t,this.parameters={},this._hasDateFunctions=void 0,this.parseTree=wc.parse(a);const{isStandardized:l,isAggregate:v,referencedFieldNames:g}=this._extractExpressionInfo(u);this._referencedFieldNames=g,this.isStandardized=l,this.isAggregate=v}static convertValueToStorageFormat(a,u=null){if(u===null)return H(a)?a.getTime():$(a)?a.toMillis():A(a)?a.toStorageFormat():D(a)?a.toStorageString():b(a)?a.toStorageFormat():a;switch(u){case"date":return H(a)?a.getTime():$(a)?a.toMillis():A(a)?a.toMilliseconds():b(a)?a.toNumber():a;case"date-only":return H(a)?k.fromDateJS(a).toString():A(a)?k.fromSqlTimeStampOffset(a).toString():$(a)?k.fromDateTime(a).toString():a;case"time-only":return H(a)?Y.fromDateJS(a).toStorageString():$(a)?Y.fromDateTime(a).toStorageString():A(a)?Y.fromSqlTimeStampOffset(a).toStorageString():D(a)?a.toStorageString():a;case"timestamp-offset":if(H(a))return W.fromJSDate(a).toStorageFormat();if($(a))return W.fromDateTime(a).toStorageFormat();if(A(a))return a.toStorageFormat()}return a}static create(a,u,t="UTC"){return new Sr(a,u,t)}get fieldNames(){return this._referencedFieldNames}testSet(a,u=ce){return!!this._evaluateNode(this.parseTree,null,u,a)}calculateValue(a,u=ce){const t=this._evaluateNode(this.parseTree,a,u,null);return t instanceof E?t.valueInMilliseconds()/864e5:t}calculateValueCompiled(a,u=ce){return this.parseTree._compiledVersion!=null?this.parseTree._compiledVersion(a,this.parameters,u,this.fieldsIndex,this.timeZone):or("esri-csp-restrictions")?this.calculateValue(a,u):(this._compileMe(),this.parseTree._compiledVersion(a,this.parameters,u,this.fieldsIndex,this.timeZone))}testFeature(a,u=ce){return!!this._evaluateNode(this.parseTree,a,u,null)}testFeatureCompiled(a,u=ce){return this.parseTree._compiledVersion!=null?!!this.parseTree._compiledVersion(a,this.parameters,u,this.fieldsIndex,this.timeZone):or("esri-csp-restrictions")?this.testFeature(a,u):(this._compileMe(),!!this.parseTree._compiledVersion(a,this.parameters,u,this.fieldsIndex,this.timeZone))}get hasDateFunctions(){return this._hasDateFunctions!=null||(this._hasDateFunctions=!1,_(this.parseTree,a=>{a.type==="current-time"?this._hasDateFunctions=!0:a.type==="function"&&(this._hasDateFunctions=this._hasDateFunctions||Ic.has(a.name.toLowerCase()))})),this._hasDateFunctions}getFunctions(){const a=new Set;return _(this.parseTree,u=>{u.type==="function"&&a.add(u.name.toLowerCase())}),Array.from(a)}getExpressions(){const a=new Map;return _(this.parseTree,u=>{if(u.type==="function"){const t=u.name.toLowerCase(),l=u.args.value[0];if(l.type==="column-reference"){const v=l.column,g=`${t}-${v}`;a.has(g)||a.set(g,{aggregateType:t,field:v})}}}),[...a.values()]}getVariables(){const a=new Set;return _(this.parseTree,u=>{u.type==="parameter"&&a.add(u.value.toLowerCase())}),Array.from(a)}_compileMe(){const a="return this.convertInterval("+this.evaluateNodeToJavaScript(this.parseTree)+")";this.parseTree._compiledVersion=new Function("feature","lookups","attributeAdapter","fieldsIndex","timeZone",a).bind(gc)}_extractExpressionInfo(a){const u=[],t=new Set;let l=!0,v=!1;return _(this.parseTree,g=>{switch(g.type){case"column-reference":{const T=a==null?void 0:a.get(g.column);let O,N;T?O=N=T.name??"":(N=g.column,O=N.toLowerCase()),t.has(O)||(t.add(O),u.push(N)),g.column=N;break}case"function":{const{name:T,args:O}=g,N=O.value.length;l&&(l=wl(T,N)),v===!1&&(v=sr(T,N));break}}}),{referencedFieldNames:Array.from(u),isStandardized:l,isAggregate:v}}evaluateNodeToJavaScript(a){switch(a.type){case"interval":return"this.makeSqlInterval("+this.evaluateNodeToJavaScript(a.value)+", "+JSON.stringify(a.qualifier)+","+JSON.stringify(a.op)+")";case"case-expression":{let u="";if(a.format==="simple"){const t=this.evaluateNodeToJavaScript(a.operand);u="( ";for(let l=0;l<a.clauses.length;l++)u+=" (this.compare('=',"+t+","+this.evaluateNodeToJavaScript(a.clauses[l].operand)+") ? ("+this.evaluateNodeToJavaScript(a.clauses[l].value)+") : ";a.else!==null?u+=this.evaluateNodeToJavaScript(a.else):u+="null",u+=" )"}else{u="( ";for(let t=0;t<a.clauses.length;t++)u+=" this.makeBool("+this.evaluateNodeToJavaScript(a.clauses[t].operand)+")===true ? ("+this.evaluateNodeToJavaScript(a.clauses[t].value)+") : ";a.else!==null?u+=this.evaluateNodeToJavaScript(a.else):u+="null",u+=" )"}return u}case"parameter":return"this.lookup("+JSON.stringify(a.value.toLowerCase())+",lookups)";case"expression-list":{let u="[";for(const t of a.value)u!=="["&&(u+=","),u+=this.evaluateNodeToJavaScript(t);return u+="]",u}case"unary-expression":return"this.ternaryNot("+this.evaluateNodeToJavaScript(a.expr)+")";case"binary-expression":switch(a.operator){case"AND":return"this.ternaryAnd("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+" )";case"OR":return"this.ternaryOr("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+" )";case"IS":if(a.right.type!=="null")throw new m(d.UnsupportedIsRhs);return"this.equalsNull("+this.evaluateNodeToJavaScript(a.left)+")";case"ISNOT":if(a.right.type!=="null")throw new m(d.UnsupportedIsRhs);return"(!(this.equalsNull("+this.evaluateNodeToJavaScript(a.left)+")))";case"IN":return"this.applyIn("+this.evaluateNodeToJavaScript(a.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(a.right)+"), timeZone)";case"NOT IN":return"this.ternaryNot(this.applyIn("+this.evaluateNodeToJavaScript(a.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(a.right)+"), timeZone))";case"BETWEEN":return"this.between("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+", timeZone)";case"NOTBETWEEN":return"this.notbetween("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+", timeZone)";case"LIKE":return"this.applyLike("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+","+JSON.stringify(a.escape)+")";case"NOT LIKE":return"this.ternaryNot(this.applyLike("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+","+JSON.stringify(a.escape)+"))";case"<>":case"<":case">":case">=":case"<=":case"=":return"this.compare("+JSON.stringify(a.operator)+","+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+", timeZone)";case"*":case"-":case"+":case"/":case"||":return"this.calculate("+JSON.stringify(a.operator)+","+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+", timeZone)"}throw new m(d.UnsupportedOperator,{operator:a.operator});case"null":case"boolean":case"string":case"number":return JSON.stringify(a.value);case"time":return"this.evaluateTime("+JSON.stringify(a.value)+")";case"date":return"this.evaluateDate("+JSON.stringify(a.value)+", 'unknown')";case"timestamp":return"this.evaluateTimestamp("+JSON.stringify(a.value)+", 'unknown')";case"current-time":return a.mode==="date"?"this.currentDate(timeZone)":"this.currentTimestamp(timeZone)";case"column-reference":return"this.featureValue(feature,"+JSON.stringify(a.column)+",fieldsIndex,attributeAdapter)";case"function":return"this.evaluateFunction("+JSON.stringify(a.name)+","+this.evaluateNodeToJavaScript(a.args)+", timeZone)"}throw new m(d.UnsupportedSyntax,{node:a.type})}_evaluateNode(a,u,t,l){var g;let v;switch(a.type){case"interval":{const T=this._evaluateNode(a.value,u,t,l);return E.createFromValueAndQualifier(T,a.qualifier,a.op)}case"case-expression":if(a.format==="simple"){const T=this._evaluateNode(a.operand,u,t,l);for(let O=0;O<a.clauses.length;O++)if(z(T,this._evaluateNode(a.clauses[O].operand,u,t,l),"=",this.timeZone))return this._evaluateNode(a.clauses[O].value,u,t,l);if(a.else!==null)return this._evaluateNode(a.else,u,t,l)}else{for(let T=0;T<a.clauses.length;T++)if(Or(this._evaluateNode(a.clauses[T].operand,u,t,l)))return this._evaluateNode(a.clauses[T].value,u,t,l);if(a.else!==null)return this._evaluateNode(a.else,u,t,l)}return null;case"parameter":return v=this.parameters[a.value.toLowerCase()],H(v)?U.fromJSDate(v):v instanceof ks?v.toDateTime():v;case"expression-list":{const T=[];for(const O of a.value)T.push(this._evaluateNode(O,u,t,l));return T}case"unary-expression":return Ae(this._evaluateNode(a.expr,u,t,l));case"binary-expression":switch(a.operator){case"AND":return xr(this._evaluateNode(a.left,u,t,l),this._evaluateNode(a.right,u,t,l));case"OR":return Cr(this._evaluateNode(a.left,u,t,l),this._evaluateNode(a.right,u,t,l));case"IS":if(a.right.type!=="null")throw new m(d.UnsupportedIsRhs);return this._evaluateNode(a.left,u,t,l)===null;case"ISNOT":if(a.right.type!=="null")throw new m(d.UnsupportedIsRhs);return this._evaluateNode(a.left,u,t,l)!==null;case"IN":{const T=Ge(this._evaluateNode(a.right,u,t,l));return Ke(this._evaluateNode(a.left,u,t,l),T,this.timeZone)}case"NOT IN":{const T=Ge(this._evaluateNode(a.right,u,t,l));return Ae(Ke(this._evaluateNode(a.left,u,t,l),T,this.timeZone))}case"BETWEEN":{const T=this._evaluateNode(a.left,u,t,l),O=this._evaluateNode(a.right,u,t,l);return T==null||O[0]==null||O[1]==null?null:z(T,O[0],">=",this.timeZone)&&z(T,O[1],"<=",this.timeZone)}case"NOTBETWEEN":{const T=this._evaluateNode(a.left,u,t,l),O=this._evaluateNode(a.right,u,t,l);return T==null||O[0]==null||O[1]==null?null:z(T,O[0],"<",this.timeZone)||z(T,O[1],">",this.timeZone)}case"LIKE":return Xe(this._evaluateNode(a.left,u,t,l),this._evaluateNode(a.right,u,t,l),a.escape);case"NOT LIKE":return Ae(Xe(this._evaluateNode(a.left,u,t,l),this._evaluateNode(a.right,u,t,l),a.escape));case"<>":case"<":case">":case">=":case"<=":case"=":return z(this._evaluateNode(a.left,u,t,l),this._evaluateNode(a.right,u,t,l),a.operator,this.timeZone);case"-":case"+":case"*":case"/":case"||":return Nr(a.operator,this._evaluateNode(a.left,u,t,l),this._evaluateNode(a.right,u,t,l),this.timeZone)}case"null":case"boolean":case"string":case"number":return a.value;case"date":return a.parsedValue??(a.parsedValue=gr(a.value,"unknown")),a.parsedValue;case"timestamp":return a.parsedValue??(a.parsedValue=De(a.value,"unknown")),a.parsedValue;case"time":return tt(a.value);case"current-time":return a.mode==="date"?k.fromNow(this.timeZone):Pe(new Date,this.timeZone);case"column-reference":return Mr(u,a.column,this.fieldsIndex,t);case"data-type":return a.value;case"function":{if(this.isAggregate&&sr(a.name,a.args.value.length)){const O=[];for(const N of((g=a.args)==null?void 0:g.value)||[]){const C=[];for(const P of l||[])C.push(this._evaluateNode(N,P,t,null));O.push(C)}return Qs(a.name,O)}const T=this._evaluateNode(a.args,u,t,l);return rt(a.name,T,this.timeZone)}}throw new m(d.UnsupportedSyntax,{node:a.type})}};function Or(i){return i===!0}function Ge(i){return Array.isArray(i)?i:[i]}function Ae(i){return i!==null?i!==!0:null}function xr(i,a){return i!=null&&a!=null?i===!0&&a===!0:i!==!1&&a!==!1&&null}function Cr(i,a){return i!=null&&a!=null?i===!0||a===!0:i===!0||a===!0||null}function Ke(i,a,u){if(i==null)return null;let t=!1;for(const l of a)if(l==null)t=null;else{if(i===l){t=!0;break}if(We(i)&&We(l)&&(t=z(i,l,"="),t))break}return t}const fr="-[]/{}()*+?.\\^$|";var oe;function Tc(i,a){const u=a;let t="",l=oe.Normal;for(let v=0;v<i.length;v++){const g=i.charAt(v);switch(l){case oe.Normal:g===u?l=oe.Escaped:fr.includes(g)?t+="\\"+g:t+=g==="%"?".*":g==="_"?".":g;break;case oe.Escaped:fr.includes(g)?t+="\\"+g:t+=g,l=oe.Normal}}return new RegExp("^"+t+"$","m")}function Xe(i,a,u){return i==null?null:Tc(a,u).test(i)}function Nc(i){return i&&typeof i.attributes=="object"}function Mr(i,a,u,t){const l=t.getAttribute(i,a),v=u==null?void 0:u.get(a);return l==null||(v==null?void 0:v.type)!=="esriFieldTypeDate"&&(v==null?void 0:v.type)!=="date"?l==null||(v==null?void 0:v.type)!=="esriFieldTypeDateOnly"&&(v==null?void 0:v.type)!=="date-only"?l==null||(v==null?void 0:v.type)!=="esriFieldTypeTimeOnly"&&(v==null?void 0:v.type)!=="time-only"?l==null||(v==null?void 0:v.type)!=="esriFieldTypeTimestampOffset"&&(v==null?void 0:v.type)!=="timestamp-offset"?l:new W(l):Y.fromReader(l):k.fromReader(l):Pe(new Date(l),(u==null?void 0:u.getLuxonTimeZone(v.name))??Ys.utcInstance)}(function(i){i[i.Normal=0]="Normal",i[i.Escaped=1]="Escaped"})(oe||(oe={}));const ce={getAttribute:(i,a)=>(Nc(i)?i.attributes:i)[a]},Cc=Object.freeze(Object.defineProperty({__proto__:null,WhereClause:yc,defaultAttributeAdapter:ce},Symbol.toStringTag,{value:"Module"}));export{Cc as W,B as a,m as n,W as r,xc as s,d as t,yc as x};
