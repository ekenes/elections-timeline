{"version":3,"mappings":"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","names":["n","a","e","i","t","s","o","r","u","m","j","_a","has","h","d","S","__vitePreload","f","y","l","F","p","c","x"],"sources":["../../node_modules/@arcgis/core/rest/query/executeForExtent.js","../../node_modules/@arcgis/core/layers/graphics/sources/support/QueryTask.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport\"../../geometry.js\";import{parseUrl as t}from\"../utils.js\";import{executeQueryForExtent as o}from\"./operations/query.js\";import r from\"../support/Query.js\";import m from\"../../geometry/Extent.js\";async function n(n,a,e){const i=t(n),s=await o(i,r.from(a),{...e}),u=s.data.extent;return!u||isNaN(u.xmin)||isNaN(u.ymin)||isNaN(u.xmax)||isNaN(u.ymax)?{count:s.data.count,extent:null}:{count:s.data.count,extent:m.fromJSON(u)}}export{n as executeForExtent};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../chunks/tslib.es6.js\";import t from\"../../../../core/Accessor.js\";import r from\"../../../../core/Error.js\";import has from\"../../../../core/has.js\";import{whenOrAbort as o}from\"../../../../core/promiseUtils.js\";import{urlToObject as s}from\"../../../../core/urlUtils.js\";import{property as i}from\"../../../../core/accessorSupport/decorators/property.js\";import\"../../../../core/Logger.js\";import\"../../../../core/RandomLCG.js\";import{subclass as u}from\"../../../../core/accessorSupport/decorators/subclass.js\";import{equals as a}from\"../../../../geometry/support/spatialReferenceUtils.js\";import{getMimeTypeFormatId as n,getFilenameFormatId as c}from\"../../../support/infoFor3D.js\";import{DataLayerSource as p}from\"../../../support/source/DataLayerSource.js\";import{parseUrl as l}from\"../../../../rest/utils.js\";import{executeForCount as m}from\"../../../../rest/query/executeForCount.js\";import{executeForExtent as f}from\"../../../../rest/query/executeForExtent.js\";import{executeForIds as y}from\"../../../../rest/query/executeForIds.js\";import{executeRawQueryJSON as d}from\"../../../../rest/query/executeQueryJSON.js\";import{executeRawQueryPBF as h}from\"../../../../rest/query/executeQueryPBF.js\";import S from\"../../../../rest/support/FeatureSet.js\";import F from\"../../../../rest/support/Query.js\";let j=class extends t{constructor(e){super(e),this.dynamicDataSource=null,this.fieldsIndex=null,this.gdbVersion=null,this.infoFor3D=null,this.pbfSupported=!1,this.queryAttachmentsSupported=!1,this.sourceSpatialReference=null,this.url=null}get parsedUrl(){return s(this.url)}async execute(e,t){const r=await this.executeJSON(e,t);return this.featureSetFromJSON(e,r,t)}async executeJSON(e,t){const r=this._normalizeQuery(e),o=null!=e.outStatistics?.[0],s=has(\"featurelayer-pbf-statistics\"),i=!o||s;let u;if(this.pbfSupported&&i)try{u=await h(this.url,r,t)}catch(a){if(\"query:parsing-pbf\"!==a.name)throw a;this.pbfSupported=!1}return this.pbfSupported&&i||(u=await d(this.url,r,t)),this._normalizeFields(u.fields),u}async featureSetFromJSON(e,t,r){if(!this._queryIs3DObjectFormat(e)||null==this.infoFor3D||!t.features)return S.fromJSON(t);const{meshFeatureSetFromJSON:s}=await o(import(\"../../../../rest/support/meshFeatureSet.js\"),r);return s(e,this.infoFor3D,t)}executeForCount(e,t){return m(this.url,this._normalizeQuery(e),t)}executeForExtent(e,t){return f(this.url,this._normalizeQuery(e),t)}executeForIds(e,t){return y(this.url,this._normalizeQuery(e),t)}async executeRelationshipQuery(e,t){const[{default:r},{executeRelationshipQuery:s}]=await o(Promise.all([import(\"../../../../rest/support/RelationshipQuery.js\"),import(\"../../../../rest/query/executeRelationshipQuery.js\")]),t);return e=r.from(e),(this.gdbVersion||this.dynamicDataSource)&&((e=e.clone()).gdbVersion=e.gdbVersion||this.gdbVersion,e.dynamicDataSource=e.dynamicDataSource||this.dynamicDataSource),s(this.url,e,t)}async executeRelationshipQueryForCount(e,t){const[{default:r},{executeRelationshipQueryForCount:s}]=await o(Promise.all([import(\"../../../../rest/support/RelationshipQuery.js\"),import(\"../../../../rest/query/executeRelationshipQuery.js\")]),t);return e=r.from(e),(this.gdbVersion||this.dynamicDataSource)&&((e=e.clone()).gdbVersion=e.gdbVersion||this.gdbVersion,e.dynamicDataSource=e.dynamicDataSource||this.dynamicDataSource),s(this.url,e,t)}async executeAttachmentQuery(e,t){const{executeAttachmentQuery:r,fetchAttachments:s,processAttachmentQueryResult:i}=await o(import(\"../../../../rest/query/operations/queryAttachments.js\"),t),u=l(this.url);return i(u,await(this.queryAttachmentsSupported?r(u,e,t):s(u,e,t)))}async executeTopFeaturesQuery(e,t){const{executeTopFeaturesQuery:r}=await o(import(\"../../../../rest/query/executeTopFeaturesQuery.js\"),t);return r(this.parsedUrl,e,this.sourceSpatialReference,t)}async executeForTopIds(e,t){const{executeForTopIds:r}=await o(import(\"../../../../rest/query/executeForTopIds.js\"),t);return r(this.parsedUrl,e,t)}async executeForTopExtents(e,t){const{executeForTopExtents:r}=await o(import(\"../../../../rest/query/executeForTopExtents.js\"),t);return r(this.parsedUrl,e,t)}async executeForTopCount(e,t){const{executeForTopCount:r}=await o(import(\"../../../../rest/query/executeForTopCount.js\"),t);return r(this.parsedUrl,e,t)}_normalizeQuery(e){let t=F.from(e);t.sourceSpatialReference=t.sourceSpatialReference||this.sourceSpatialReference,(this.gdbVersion||this.dynamicDataSource)&&(t=t===e?t.clone():t,t.gdbVersion=e.gdbVersion||this.gdbVersion,t.dynamicDataSource=e.dynamicDataSource?p.from(e.dynamicDataSource):this.dynamicDataSource);const{infoFor3D:o}=this;if(null!=o&&this._queryIs3DObjectFormat(e)){t=t===e?t.clone():t,t.formatOf3DObjects=null;const{supportedFormats:s,queryFormats:i}=o,u=n(\"model/gltf-binary\",s)??c(\"glb\",s),p=n(\"model/gltf+json\",s)??c(\"gltf\",s);for(const e of i){if(e===u){t.formatOf3DObjects=e;break}e!==p||t.formatOf3DObjects||(t.formatOf3DObjects=e)}if(!t.formatOf3DObjects)throw new r(\"query:unsupported-3d-query-formats\",\"Could not find any supported 3D object query format. Only supported formats are 3D_glb and 3D_gltf\");if(t.outSpatialReference&&!a(t.outSpatialReference,this.sourceSpatialReference))throw new r(\"query:unsupported-out-spatial-reference\",\"3D object feature services do not support projection of geometries\");if(null==t.outFields||!t.outFields.includes(\"*\")){t=t===e?t.clone():t,null==t.outFields&&(t.outFields=[]);const{originX:r,originY:s,originZ:i,translationX:u,translationY:a,translationZ:n,scaleX:c,scaleY:p,scaleZ:l,rotationX:m,rotationY:f,rotationZ:y,rotationDeg:d}=o.transformFieldRoles;t.outFields.push(r,s,i,u,a,n,c,p,l,m,f,y,d)}}return t}_normalizeFields(e){if(null!=this.fieldsIndex&&null!=e)for(const t of e){const e=this.fieldsIndex.get(t.name);e&&Object.assign(t,e.toJSON())}}_queryIs3DObjectFormat(e){return null!=this.infoFor3D&&!0===e.returnGeometry&&\"xyFootprint\"!==e.multipatchOption&&!e.outStatistics}};e([i({type:p})],j.prototype,\"dynamicDataSource\",void 0),e([i()],j.prototype,\"fieldsIndex\",void 0),e([i()],j.prototype,\"gdbVersion\",void 0),e([i()],j.prototype,\"infoFor3D\",void 0),e([i({readOnly:!0})],j.prototype,\"parsedUrl\",null),e([i()],j.prototype,\"pbfSupported\",void 0),e([i()],j.prototype,\"queryAttachmentsSupported\",void 0),e([i()],j.prototype,\"sourceSpatialReference\",void 0),e([i({type:String})],j.prototype,\"url\",void 0),j=e([u(\"esri.layers.graphics.sources.support.QueryTask\")],j);const x=j;export{x as default};\n"],"file":"assets/QueryTask-a0500bd0.js"}