import{c3 as et,ab as Ne,bu as tt,f7 as nt,s as X,ai as it,eu as Z,y as d,z as u,A as Le,bM as rt,x as de,fl as re,dL as we,dd as K,bv as ye,bn as ce,k_ as De,bk as Ye,gz as at,gl as ot,gm as st,bT as lt,gk as pt,ew as dt,bU as ut,dY as yt,d$ as ct,k$ as ht,dM as ue,dN as ie,gn as mt,E as fe,bC as ft,go as gt,gp as Tt,C as bt,bl as wt,aF as Et,aL as q,l0 as It,l1 as Lt,l2 as Nt,l3 as Dt,gq as Mt,gr as vt,gs as Rt,e1 as St,gS as $t,gT as _t,gt as Ct,l4 as kt,gu as At,D as Ot,gv as xt,hi as jt,ev as Ft,kK as qt,br as Pt,bX as Bt}from"./index-09dc31eb.js";import{o as Gt}from"./featureConversionUtils-92abdc6c.js";import"./GraphicsLayer-3f96bb53.js";import{W as Ut,M as ae,r as ze}from"./knowledgeGraphService-3d37af1e.js";import{s as te}from"./GraphQueryStreaming-1578160a.js";import{m as Ht}from"./FeatureStore-45c699bf.js";import{$ as Qt}from"./QueryEngine-a42ff977.js";import{y as Jt,u as ge}from"./clientSideDefaults-d5bf9ef2.js";const V="ESRI__ID",Ee="ESRI__OriginID",Ie="ESRI__DestID",Ze="ESRI__LayoutGeometry",Me="ESRI__AggregationCount",se="LC.ESRI__IsSpatial",Vt={initializeLayersFromClientData:async(e,t)=>{if(t||(t=[...e.layers,...e.tables].map(o=>o.graphTypeName)),(t==null?void 0:t.length)===0)return;const i=new Map;for(const o of t)i.set(o,ve(e,o));const n=await Ut(e.dataManager.knowledgeGraph,Array.from(i.values()));for(const o of[...e.layers,...e.tables]){const r=o.objectType.name;if(r===null)continue;const a=n.get(ve(e,r));if(a){const s=JSON.parse(a);s===null||typeof s!="object"||s.hasOwnProperty("showLabels")||(s.showLabels=!1),o.read(s,{origin:"service"})}}}},ve=(e,t)=>e.type==="knowledge-graph"?`${t}/Map`:`${t}/LinkChart/LinkChartSubLayer`;async function yn(e,t){return Vt.initializeLayersFromClientData(e,t)}let Te=class ne{constructor(){this._featureLookup=new Map}static getInstance(){return ne.instance||(ne.instance=new ne),ne.instance}static resetInstance(){ne.instance&&(ne.instance=null)}deleteFromStore(t){t.forEach(i=>{this._featureLookup.delete(i)})}readFromStoreByList(t){const i=[];return t.forEach(n=>{const o=this.readFromStoreById(n);o&&i.push(o)}),i}readFromStoreById(t){return this._featureLookup.get(t)??null}writeToStore(t,i,n){const o=[];return t.forEach(r=>{if(!(r!=null&&r.id))return;r.properties||(r.properties=[]);let a,s=null;if(n&&r.properties[n]&&(s=Gt(r.properties[n])),"originId"in r&&"destinationId"in r&&(r.properties[Ee]=r.originId,r.properties[Ie]=r.destinationId),r.properties[i]=r.id,r.id&&this._featureLookup.has(r.id)&&this._featureLookup.get(r.id).attributes){const p=this._featureLookup.get(r.id),c=JSON.parse(JSON.stringify(Object.assign(p.attributes,r.properties)));n&&r.properties[n]&&(c[n]=et(r.properties[n])),a=new Ne(s?JSON.parse(JSON.stringify(s)):p!=null&&p.geometry?JSON.parse(JSON.stringify(p.geometry)):null,c,null,r.properties[i])}else a=new Ne(s?JSON.parse(JSON.stringify(s)):null,r.properties,null,r.properties[i]);this._featureLookup.set(r.id,a),o.push(a)}),o}},be,b=null;function cn(){return be||(be=tt(()=>import("./lclayout-18bf309c.js"),["assets/lclayout-18bf309c.js","assets/_commonjsHelpers-2f3e7994.js"]).then(e=>e.l).then(({default:e})=>e({locateFile:t=>nt(`esri/libs/linkchartlayout/${t}`)})).then(e=>{Wt(e)}),be)}function Wt(e){b=e}var Re,Se,le,pe;function Yt(e){const t=Object.keys(le).filter(n=>isNaN(parseInt(n,10))).indexOf(e.timeDirection),i=Object.keys(pe).filter(n=>isNaN(parseInt(n,10))).indexOf(e.eventsTicksVisualization);return{timeDirection:{value:t>-1?t:le.right},timeBannerUTCOffsetInMinutes:e.timeBannerUTCOffsetInMinutes,eventsTicksVisualization:{value:i>-1?i:pe.startAndEnd},showDurationLineForNonZeroDurationEntityEvents:e.showDurationLineForNonZeroDurationEntityEvents,durationLineWidth:e.durationLineWidth,entityPositionAtDurationRatio:e.entityPositionAtDurationRatio,showNonZeroDurationIntervalBounds:e.showNonZeroDurationIntervalBounds,separateTimeOverlaps:e.separateTimeOverlaps,separateTimelineOverlaps:e.separateTimelineOverlaps,moveFirstBends:e.moveFirstBends,secondBendRatio:e.secondBendRatio,lineSeparationMultiplier:e.lineSeparationMultiplier,spaceSeparatedLinesEvenly:e.spaceSeparatedLinesEvenly,useBezierCurves:e.useBezierCurves,separatedLineShapeRatio:e.separatedLineShapeRatio}}function ee(e,t,i,n,o,r){const a=i.length,s=o.length,p=Float64Array.BYTES_PER_ELEMENT,c=Uint32Array.BYTES_PER_ELEMENT,m=Uint8Array.BYTES_PER_ELEMENT,y=16,f=y+a*(m+2*p)+s*(2*c),I=b._malloc(f);try{const E=I+y-I%y,l=E+a*p,L=l+a*p,v=L+s*c,C=v+s*c,z=()=>[b.HEAPF64.subarray(E>>3,(E>>3)+a),b.HEAPF64.subarray(l>>3,(l>>3)+a),b.HEAPU32.subarray(L>>2,(L>>2)+s),b.HEAPU32.subarray(v>>2,(v>>2)+s),b.HEAPU8.subarray(C,C+a)],[B,O,S,A,G]=z();B.set(i),O.set(n),S.set(o),A.set(r),G.set(t);let x=e(a,C,E,l,s,L,v),j=null,F=null;if(x){const h=b.getLayoutLinksTypes(),k=b.getLayoutLinksVerticesEndIndices(),$=b.getLayoutLinksVertices(),_=b.countLayoutLinksVertices();!s||h&&k?_&&!$?x=!1:(j={types:new Uint8Array(b.HEAPU8.subarray(h,h+s)),vertexEndIndex:new Uint32Array(b.HEAPU32.subarray(k>>2,(k>>2)+s)),vertices:new Float64Array(b.HEAPF64.subarray($>>3,($>>3)+2*_))},F=b.getAuxiliaryGraphicElements()):x=!1}const[U,H,Q,Y,N]=z();return i.set(U),n.set(H),o.set(Q),r.set(Y),t.set(N),{success:x,links:j,graphics:F}}finally{b._free(I),b.cleanupLayout()}}(function(e){e[e.None=0]="None",e[e.IsMovable=1]="IsMovable",e[e.IsGeographic=2]="IsGeographic",e[e.IsRoot=4]="IsRoot",e[e.IsOld=8]="IsOld"})(Re||(Re={})),function(e){e[e.Regular=0]="Regular",e[e.Curved=1]="Curved",e[e.Recursive=2]="Recursive"}(Se||(Se={})),function(e){e[e.right=0]="right",e[e.left=1]="left",e[e.top=2]="top",e[e.bottom=3]="bottom"}(le||(le={})),function(e){e[e.none=0]="none",e[e.startOnly=1]="startOnly",e[e.startAndEnd=2]="startAndEnd"}(pe||(pe={}));const $e=2,_e=1,Ce=-1;var ke,Ae,Oe,xe,je,Fe,qe,Pe,Be;(function(e){function t(){return b.getMinIdealEdgeLength()}function i(n,o,r,a,s,p=$e,c=_e,m=Ce){return ee((y,f,I,E,l,L,v)=>b.applyForceDirectedLayout(y,f,I,E,l,L,v,p,c,m),n,o,r,a,s)}e.getMinIdealEdgeLength=t,e.apply=i})(ke||(ke={})),function(e){function t(i,n,o,r,a,s=$e,p=_e,c=Ce){return ee((m,y,f,I,E,l,L)=>b.applyCommunityLayout(m,y,f,I,E,l,L,s,p,c),i,n,o,r,a)}e.apply=t}(Ae||(Ae={})),function(e){function t(i,n,o,r,a){return ee(b.applySimpleLayout,i,n,o,r,a)}e.apply=t}(Oe||(Oe={})),function(e){function t(i,n,o,r,a){return ee(b.applyHierarchicalLayout,i,n,o,r,a)}e.apply=t}(xe||(xe={})),function(e){function t(i,n,o,r,a){return ee(b.applyRadialTreeLayout,i,n,o,r,a)}e.apply=t}(je||(je={})),function(e){function t(i,n,o,r,a){return ee(b.applySmartTreeLayout,i,n,o,r,a)}e.apply=t}(Fe||(Fe={})),function(e){function t(i,n,o,r,a,s,p,c,m,y,f){const I={timeDirection:le.right,timeBannerUTCOffsetInMinutes:0,eventsTicksVisualization:pe.startAndEnd,showDurationLineForNonZeroDurationEntityEvents:!0,durationLineWidth:5,entityPositionAtDurationRatio:1,showNonZeroDurationIntervalBounds:!1,separateTimeOverlaps:!0,separateTimelineOverlaps:!0,moveFirstBends:!0,secondBendRatio:.3,lineSeparationMultiplier:1,spaceSeparatedLinesEvenly:!1,useBezierCurves:!1,separatedLineShapeRatio:0};return ee((E,l,L,v,C,z,B)=>{if(r.length!==E||a.length!==E||c.length!==C||m.length!==C)return!1;const O=Float64Array.BYTES_PER_ELEMENT,S=16,A=b._malloc(S+E*O),G=b._malloc(S+E*O),x=b._malloc(S+C*O),j=b._malloc(S+C*O),F=A+S-A%S,U=G+S-G%S,H=x+S-x%S,Q=j+S-j%S;try{b.HEAPF64.subarray(F>>3,(F>>3)+E).set(r),b.HEAPF64.subarray(U>>3,(U>>3)+E).set(a),b.HEAPF64.subarray(H>>3,(H>>3)+C).set(c),b.HEAPF64.subarray(Q>>3,(Q>>3)+C).set(m);const Y=Yt(Object.assign(I,f));return b.applyChronologicalLayout(E,l,L,v,F,U,C,z,B,H,Q,y,Y)}finally{b._free(A),b._free(G),b._free(x),b._free(j)}},i,n,o,s,p)}e.apply=t}(qe||(qe={})),function(e){e[e.Undirected=0]="Undirected",e[e.Directed=1]="Directed",e[e.Reversed=2]="Reversed"}(Pe||(Pe={})),function(e){e[e.ByCC_Raw=0]="ByCC_Raw",e[e.ByCC_NormalizeGlobally=1]="ByCC_NormalizeGlobally",e[e.ByCC_NormalizeByCC=2]="ByCC_NormalizeByCC"}(Be||(Be={}));var he;(function(e){e.ELEMENTUID="ELEMENTUID",e.TYPENAME="TYPENAME"})(he||(he={}));he.ELEMENTUID,he.TYPENAME;var Ge,Ue;(function(e){e[e.ELEMENTUID=0]="ELEMENTUID",e[e.TYPENAME=1]="TYPENAME"})(Ge||(Ge={})),function(e){e[e.ELEMENTUID=0]="ELEMENTUID",e[e.TYPENAME=1]="TYPENAME",e[e.FROMUID=2]="FROMUID",e[e.TOUID=3]="TOUID"}(Ue||(Ue={}));var He,Qe,Je,me;(function(e){e[e.featureResult=0]="featureResult",e[e.countResult=1]="countResult",e[e.idsResult=2]="idsResult"})(He||(He={})),function(e){e[e.upperLeft=0]="upperLeft",e[e.lowerLeft=1]="lowerLeft"}(Qe||(Qe={})),function(e){e[e.sqlTypeBigInt=0]="sqlTypeBigInt",e[e.sqlTypeBinary=1]="sqlTypeBinary",e[e.sqlTypeBit=2]="sqlTypeBit",e[e.sqlTypeChar=3]="sqlTypeChar",e[e.sqlTypeDate=4]="sqlTypeDate",e[e.sqlTypeDecimal=5]="sqlTypeDecimal",e[e.sqlTypeDouble=6]="sqlTypeDouble",e[e.sqlTypeFloat=7]="sqlTypeFloat",e[e.sqlTypeGeometry=8]="sqlTypeGeometry",e[e.sqlTypeGUID=9]="sqlTypeGUID",e[e.sqlTypeInteger=10]="sqlTypeInteger",e[e.sqlTypeLongNVarchar=11]="sqlTypeLongNVarchar",e[e.sqlTypeLongVarbinary=12]="sqlTypeLongVarbinary",e[e.sqlTypeLongVarchar=13]="sqlTypeLongVarchar",e[e.sqlTypeNChar=14]="sqlTypeNChar",e[e.sqlTypeNVarChar=15]="sqlTypeNVarChar",e[e.sqlTypeOther=16]="sqlTypeOther",e[e.sqlTypeReal=17]="sqlTypeReal",e[e.sqlTypeSmallInt=18]="sqlTypeSmallInt",e[e.sqlTypeSqlXml=19]="sqlTypeSqlXml",e[e.sqlTypeTime=20]="sqlTypeTime",e[e.sqlTypeTimestamp=21]="sqlTypeTimestamp",e[e.sqlTypeTimestamp2=22]="sqlTypeTimestamp2",e[e.sqlTypeTinyInt=23]="sqlTypeTinyInt",e[e.sqlTypeVarbinary=24]="sqlTypeVarbinary",e[e.sqlTypeVarchar=25]="sqlTypeVarchar"}(Je||(Je={})),function(e){e[e.OID_ARRAY=0]="OID_ARRAY",e[e.GLOBALID_ARRAY=1]="GLOBALID_ARRAY",e[e.STRING_ARRAY=2]="STRING_ARRAY",e[e.IDENTIFIER_ARRAY=3]="IDENTIFIER_ARRAY"}(me||(me={}));function zt(e){if(!e.spatialReference.isWGS84)throw new X("knowledge-graph:layer-support-utils","The extentToInBoundsRings function only supports WGS84 spatial references.");return e.clone().normalize().map(t=>[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]])}async function hn(e,t){var r,a;const i=[],n=new Map,o=[];if((r=t.dataModel)!=null&&r.relationshipTypes)for(const s of t.dataModel.relationshipTypes)s.name&&n.set(s.name,[]);for(const s of e)n.has(s.typeName)&&((a=n.get(s.typeName))==null||a.push(s.id));for(const[s,p]of n){if(p.length<1)continue;const c=new te({openCypherQuery:`MATCH (n)-[r:${s}]->(m) WHERE id(r) in $ids RETURN id(n), labels(n)[0], id(m), labels(m)[0]`,bindParameters:{ids:p}});o.push(ae(t,c).then(async m=>{const y=m.resultRowsStream.getReader();for(;;){const{done:f,value:I}=await y.read();if(f)break;for(const E of I)i.push({id:E[0],typeName:E[1]}),i.push({id:E[2],typeName:E[3]})}}))}return await Promise.all(o),i}async function mn(e,t){t??(t=!1);const i={generateAllSublayers:t,namedTypeDefinitions:new Map};return await Kt(e).then(n=>{en(n,i)}),i}async function fn(e){const t=await ze(),i=new t.MapOfObjectIdentifierSets;Zt(i,t,e);const n=new t.MapOfObjectIdentifierSetsEncoder;try{n.set_map_of_identifier_sets(i),n.encode();const o=n.get_encoding_result();if(o.error.error_code!==0)throw new X("knowledge-graph:layer-support-utils",o.error.error_message);const r=structuredClone(o.get_byte_buffer());return n.delete(),r}finally{i.delete()}}function Zt(e,t,i){for(const[n,o]of i.namedTypeDefinitions){if(!o.members||o.useAllData)continue;const r=o.members.keys(),a=new t.GlobalIdArray,s=new t.ObjectIdentifierSet;for(const p of r)a.add_globalid(p);s.set_globalid_array(a),a.delete(),e.put_identifier_set(n,s),s.delete()}return e}async function Kt(e){const t=await it(e,{responseType:"array-buffer"}),i=await t.data;return Xt(new Uint8Array(i))}async function Xt(e){const t=new(await ze()).MapOfObjectIdentifierSetsDecoder,i=t.decode(new Uint8Array(e)),n=new Map;if(i.error_code!==0)throw new X("knowledge-graph:layer-support-utils",i.error_message);const o=t.get_map_of_identifier_sets(),r=o.keys,a=r.size();for(let s=0;s<a;s++){const p=r.get(s),c=o.query_identifier_set(p),m=[];if(c.id_array_type.value===me.GLOBALID_ARRAY){const y=c.get_globalid_array(),f=y.count();for(let I=0;I<f;I++)m.push(y.get_globalid_at(I))}else{if(c.id_array_type.value!==me.IDENTIFIER_ARRAY)throw new X("knowledge-graph:layer-support-utils","Tried to encode an unexpected ID Array type.");{const y=c.get_identifier_array(),f=y.count();for(let I=0;I<f;I++)m.push(y.get_identifier_at(I).toString())}}n.set(p,m)}return t.delete(),n}function en(e,t){for(const[i,n]of e){const o=Z(t.namedTypeDefinitions,i,()=>({useAllData:!1,members:new Map}));for(const r of n)o.members.has(r)||o.members.set(r,{id:r})}return t}let J=class extends rt{constructor(e){var i,n,o;super(e),this._processingCacheUpdatesLookup=new Map,this.knowledgeGraph=null,this.inclusionModeDefinition={generateAllSublayers:!0,namedTypeDefinitions:new Map},this.entityTypeNames=new Set,this.relationshipTypeNames=new Set,this.geographicLookup=new Map,this.sublayerCaches=new Map,this.nodeConnectionsLookup=new Map,this.relationshipConnectionsLookup=new Map,this.memberIdTypeLookup=new Map;const t=new Map;(i=e.knowledgeGraph.dataModel.entityTypes)==null||i.forEach(r=>{var a,s;r.name&&(t.set(r.name,"entity"),this._processingCacheUpdatesLookup.set(r.name,[]),e.inclusionModeDefinition&&!((a=e.inclusionModeDefinition)!=null&&a.generateAllSublayers)||this.entityTypeNames.add(r.name),(s=r.properties)==null||s.forEach(p=>{p.geometryType&&p.geometryType!=="esriGeometryNull"&&this.geographicLookup.set(r.name,{name:p.name??"",geometryType:p.geometryType})}))}),(n=e.knowledgeGraph.dataModel.relationshipTypes)==null||n.forEach(r=>{var a,s;r.name&&(t.set(r.name,"relationship"),this._processingCacheUpdatesLookup.set(r.name,[]),e.inclusionModeDefinition&&!((a=e.inclusionModeDefinition)!=null&&a.generateAllSublayers)||this.relationshipTypeNames.add(r.name),(s=r.properties)==null||s.forEach(p=>{p.geometryType&&p.geometryType!=="esriGeometryNull"&&this.geographicLookup.set(r.name,{name:p.name??"",geometryType:p.geometryType})}))}),(o=e.inclusionModeDefinition)==null||o.namedTypeDefinitions.forEach((r,a)=>{var p,c;if(t.get(a)==="entity")this.entityTypeNames.add(a);else{if(t.get(a)!=="relationship")return de.getLogger(this).warn(`A named type, ${a}, was in the inclusion list that wasn't in the data model and will be removed`),void((p=e.inclusionModeDefinition)==null?void 0:p.namedTypeDefinitions.delete(a));this.relationshipTypeNames.add(a)}const s=new Map;(c=r.members)==null||c.forEach(m=>{Z(this.memberIdTypeLookup,m.id,()=>new Set).add(a);const y=this.getById(m.id);y&&s.set(m.id,y)}),this.sublayerCaches.set(a,s)})}addToLayer(e){e.forEach(({typeName:t,id:i})=>{if(!this.inclusionModeDefinition)throw new X("knowledge-graph:layer-data-manager","You cannot add to a layer's exclusion list if it was not created with an exclusion list originally");if(this.inclusionModeDefinition.namedTypeDefinitions.has(t)){if(this.inclusionModeDefinition.namedTypeDefinitions.has(t)){const n=this.inclusionModeDefinition.namedTypeDefinitions.get(t);n.members||(n.members=new Map),n.members.set(i,{id:i}),Z(this.memberIdTypeLookup,i,()=>new Set).add(t)}}else{const n=new Map;n.set(i,{id:i}),this.inclusionModeDefinition.namedTypeDefinitions.set(t,{useAllData:!1,members:n}),Z(this.memberIdTypeLookup,i,()=>new Set).add(t)}})}getById(e){return Te.getInstance().readFromStoreById(e)}async getData(e,t,i){var o,r;if(t.objectType.name&&((o=this.inclusionModeDefinition)!=null&&o.namedTypeDefinitions)&&this.inclusionModeDefinition.namedTypeDefinitions.size>0&&!this.inclusionModeDefinition.namedTypeDefinitions.has(t.objectType.name))return[];let n;if(n=e||new re({where:"1=1",outFields:["*"]}),t.parentCompositeLayer.type==="link-chart"){const a=t.parentCompositeLayer,s=this._processingCacheUpdatesLookup.get(t.objectType.name??""),p=n.outFields;p&&p.length===1&&p[0]===V&&n.where==="1=1"||await Promise.all(s??[]);const c=this.sublayerCaches.has(t.objectType.name??"")?Array.from((r=this.sublayerCaches.get(t.objectType.name))==null?void 0:r.values()):[],m=[];return c.forEach(y=>{if(this.relationshipTypeNames.has(t.objectType.name)){y.geometry=a.relationshipLinkChartDiagramLookup.get(y.attributes[t.objectIdField]);const f=this.memberIdTypeLookup.get(y.attributes[Ee]),I=this.memberIdTypeLookup.get(y.attributes[Ie]),E=this._isEndEntitySpatial(f,y,Ee),l=this._isEndEntitySpatial(I,y,Ie);y.attributes[se]=Number(E&&l)}else{y.geometry=a.entityLinkChartDiagramLookup.get(y.attributes[t.objectIdField]);const f=this.geographicLookup.get(t.objectType.name);f&&y.attributes[f.name]?y.attributes[se]=1:y.attributes[se]=0}y.attributes[Ze]=y.geometry,m.push(y)}),m}return this.retrieveDataFromService(n,t,i)}async getConnectedRecordIds(e,t){const i=[];let n="";const o=[],r=new Map;if(e.forEach(m=>{var y;if(this.memberIdTypeLookup.has(m))for(const f of this.memberIdTypeLookup.get(m)){if(!this.entityTypeNames.has(f))return;r.has(f)?(y=r.get(f))==null||y.push(m):r.set(f,[m])}}),t&&(t==null?void 0:t.length)!==0){for(const m of t)n=n+m+"|";n=n.slice(0,-1)}const a={};let s="",p=-1;for(const[m,y]of r){p++,p!==0&&(s+=" UNION ");const f=`${m}_ids`;a[f]=y,s+=t&&(t==null?void 0:t.length)!==0?`MATCH (n:${m}) WHERE id(n) IN $${f} WITH n MATCH (n)-[r:${n}]-(m) RETURN id(r), type(r), id(m), labels(m)[0]`:`MATCH (n:${m}) WHERE id(n) IN $${f} WITH n MATCH (n)-[r]-(m) RETURN id(r), type(r), id(m), labels(m)[0]`}const c=new Promise(m=>{(async()=>{const y=(await ae(this.knowledgeGraph,new te({openCypherQuery:s,bindParameters:a}))).resultRowsStream.getReader();try{for(;;){const{done:f,value:I}=await y.read();if(f)break;for(let E=0;E<I.length;E++){const l=I[E];i.push({id:l[0],typeName:l[1]}),i.push({id:l[2],typeName:l[3]})}}}catch(f){if(f.name!=="AbortError")throw f;de.getLogger(this).info("Request aborted as expected")}})().then(()=>{m()})});return o.push(c),this.refreshCacheContent(),await Promise.all(o),i}async getRelationshipsBetweenNodes(e,t){const i=[],n="MATCH (n)-[r]->(m) WHERE id(n) IN $nodeIds AND id(m) in $nodeIds AND NOT id(r) IN $relationshipExclusionIds return id(r), type(r)",o=(await ae(this.knowledgeGraph,new te({openCypherQuery:n,bindParameters:{nodeIds:e,relationshipExclusionIds:t}}))).resultRowsStream.getReader();try{for(;;){const{done:r,value:a}=await o.read();if(r)break;for(let s=0;s<a.length;s++){const p=a[s];i.push({id:p[0],typeName:p[1]})}}}catch(r){if(r.name!=="AbortError")throw r;de.getLogger(this).info("Request aborted as expected")}return i}async getRelationshipsFromNodes(e,t,i){const n=[],o="MATCH (n)-[r]-(m) WHERE id(n) IN $targetEntityIds AND id(m) in $possibleConnectionEntityIds AND NOT id(r) IN $relationshipExclusionIds return id(r), type(r)",r=(await ae(this.knowledgeGraph,new te({openCypherQuery:o,bindParameters:{targetEntityIds:e,possibleConnectionEntityIds:t,relationshipExclusionIds:i}}))).resultRowsStream.getReader();try{for(;;){const{done:a,value:s}=await r.read();if(a)break;for(let p=0;p<s.length;p++){const c=s[p];n.push({id:c[0],typeName:c[1]})}}}catch(a){if(a.name!=="AbortError")throw a;de.getLogger(this).info("Request aborted as expected")}return n}async refreshCacheContent(e,t,i,n=!0){var p,c,m,y,f,I,E;const o=Te.getInstance(),r=[],a=new Map,s=new Map;(p=this.knowledgeGraph.dataModel.entityTypes)==null||p.forEach(l=>{l.name&&s.set(l.name,l)}),(c=this.knowledgeGraph.dataModel.relationshipTypes)==null||c.forEach(l=>{l.name&&s.set(l.name,l)}),e||this.inclusionModeDefinition?e?e.forEach(l=>{var L;if(this.memberIdTypeLookup.has(l))for(const v of this.memberIdTypeLookup.get(l))a.has(v)?(L=a.get(v))==null||L.push(l):a.set(v,[l])}):(y=(m=this.inclusionModeDefinition)==null?void 0:m.namedTypeDefinitions)==null||y.forEach((l,L)=>{l.useAllData?a.set(L,null):l.members&&l.members.forEach(v=>{var C;a.has(L)&&a.get(L)!==null?(C=a.get(L))==null||C.push(v.id):a.set(L,[v.id])})}):((f=this.knowledgeGraph.dataModel.entityTypes)==null||f.forEach(l=>{l.name&&a.set(l.name,null)}),(I=this.knowledgeGraph.dataModel.entityTypes)==null||I.forEach(l=>{l.name&&a.set(l.name,null)}));for(const[l,L]of a){const v=new Promise(C=>{(async()=>{var j,F,U,H,Q,Y,N;const B=new Set,O=[];let S,A="",G=!1;if(t||((F=(j=s.get(l))==null?void 0:j.properties)==null||F.forEach(h=>{h.name&&B.add(h.name)})),i&&this.geographicLookup.has(l)){const h=(U=this.geographicLookup.get(l))==null?void 0:U.name;h&&B.add(h)}if(this.entityTypeNames.has(l))A=`MATCH (n:${l}) ${L?"WHERE id(n) IN $ids ":""}return ID(n)`,B.forEach(h=>{A+=`, n.${h}`,O.push(h)});else{if(!this.relationshipTypeNames.has(l))throw new X("knowledge-graph:layer-data-manager",`The graph type of ${l} could not be determined. Was this type set in the KG data model and inclusion definition?`);G=!0,A=`MATCH ()-[n:${l}]->() ${L?"WHERE id(n) IN $ids ":""}return ID(n), id(startNode(n)), id(endNode(n))`,B.forEach(h=>{A+=`, n.${h}`,O.push(h)})}S=new te(L?{openCypherQuery:A,bindParameters:{ids:L}}:{openCypherQuery:A});const x=(await ae(this.knowledgeGraph,S)).resultRowsStream.getReader();for(;;){const{done:h,value:k}=await x.read();if(h)break;const $=[];for(let D=0;D<k.length;D++){const w=k[D];let g=0,W=0;const R={properties:{}};for(R.id=w[g],g++,W++,G&&(R.originId=w[g],g++,W++,R.destinationId=w[g],g++,W++,Z(this.nodeConnectionsLookup,R.originId,()=>new Set).add(R.id),Z(this.nodeConnectionsLookup,R.destinationId,()=>new Set).add(R.id),Z(this.relationshipConnectionsLookup,R.id,()=>[R.originId,R.destinationId]));g<w.length;g++)R.properties[O[g-W]]=w[g];$.push(R)}const _=o.writeToStore($,V,(H=this.geographicLookup.get(l))==null?void 0:H.name);this.sublayerCaches.has(l)||this.sublayerCaches.set(l,new Map),n&&!((Q=this.inclusionModeDefinition)!=null&&Q.namedTypeDefinitions.has(l))&&((Y=this.inclusionModeDefinition)==null||Y.namedTypeDefinitions.set(l,{useAllData:!1,members:new Map})),n&&!((N=this.inclusionModeDefinition)!=null&&N.namedTypeDefinitions.get(l).members)&&(this.inclusionModeDefinition.namedTypeDefinitions.get(l).members=new Map);const M=this.sublayerCaches.get(l);_.forEach(D=>{var w,g;M==null||M.set(D.attributes[V],D),n&&!((w=this.inclusionModeDefinition)!=null&&w.namedTypeDefinitions.get(l).members.has(D.attributes[V]))&&((g=this.inclusionModeDefinition)==null||g.namedTypeDefinitions.get(l).members.set(D.attributes[V],{id:D.attributes[V]}),Z(this.memberIdTypeLookup,D.attributes[V],()=>new Set).add(l))})}})().then(()=>{C(null)})});r.push(v),(E=this._processingCacheUpdatesLookup.get(l))==null||E.push(v)}await Promise.all(r)}removeFromLayer(e){var n,o,r;const t=new Set,i=new Set(e.map(a=>a.id));for(const a of e)t.add(a.typeName),((n=this.memberIdTypeLookup.get(a.id))==null?void 0:n.size)===1?this.memberIdTypeLookup.delete(a.id):(o=this.memberIdTypeLookup.get(a.id))==null||o.delete(a.typeName),(r=this.inclusionModeDefinition)==null||r.namedTypeDefinitions.forEach((s,p)=>{var c;p===a.typeName&&((c=s.members)!=null&&c.has(a.id))&&s.members.delete(a.id)});t.forEach(a=>{var s;(s=this.sublayerCaches.get(a))==null||s.forEach((p,c)=>{var m;i.has(c)&&((m=this.sublayerCaches.get(a))==null||m.delete(c))})})}async retrieveDataFromService(e,t,i){var E,l,L,v,C,z,B,O,S,A,G,x,j,F,U,H,Q,Y;const n=Te.getInstance(),o=new Set,r=[];let a,s="",p=[];const c=t.graphType==="relationship",m=(L=(l=(E=this.inclusionModeDefinition)==null?void 0:E.namedTypeDefinitions)==null?void 0:l.get(t.objectType.name))==null?void 0:L.useAllData,y=t.parentCompositeLayer.sublayerIdsCache.get(t.objectType.name);let f=!m&&y?Array.from(y).sort():null;if((z=(C=(v=this.inclusionModeDefinition)==null?void 0:v.namedTypeDefinitions)==null?void 0:C.get(t.objectType.name))!=null&&z.useAllData)(S=(O=(B=this.inclusionModeDefinition)==null?void 0:B.namedTypeDefinitions)==null?void 0:O.get(t.objectType.name))!=null&&S.useAllData&&e.objectIds!=null&&(f=e.objectIds);else if(e.objectIds!=null&&f&&f.length>0){const N=e.objectIds;e.objectIds=f.filter(h=>N.includes(h))}else if(e.objectIds!=null)f=e.objectIds;else{if((A=this.inclusionModeDefinition)!=null&&A.namedTypeDefinitions.has(t.objectType.name)&&(!((G=this.inclusionModeDefinition.namedTypeDefinitions.get(t.objectType.name))!=null&&G.members)||((j=(x=this.inclusionModeDefinition.namedTypeDefinitions.get(t.objectType.name))==null?void 0:x.members)==null?void 0:j.size)<1))return e.objectIds=[],[];e.objectIds=f}if(e.outFields!=null){const N=e.outFields;N.includes("*")?t.fields.forEach(h=>{o.add(h.name)}):N.forEach(h=>{h!==V&&h!==t.geometryFieldName&&o.add(h)})}if(e.geometry!=null){const N=e.geometry;let h;const k=t.parentCompositeLayer.dataManager.knowledgeGraph.serviceDefinition,$=k==null?void 0:k.spatialReference,_=(F=k==null?void 0:k.serviceCapabilities)==null?void 0:F.geometryCapabilities;let M=_==null?void 0:_.geometryMaxBoundingRectangleSizeX,D=_==null?void 0:_.geometryMaxBoundingRectangleSizeY;if(N.type==="point"){let w=N;(U=w.spatialReference)!=null&&U.isWGS84||(await we(w.spatialReference,K),w=ye(w,K)),h=new ce({spatialReference:K,xmin:w.x-1e-4,ymin:w.y-1e-4,xmax:w.x+1e-4,ymax:w.y+1e-4})}else(H=N==null?void 0:N.extent)!=null&&H.spatialReference&&!((Q=N.spatialReference)!=null&&Q.isWGS84)?(await we(N.extent.spatialReference,K),h=ye(N.extent,K)):h=N.extent;if(M&&D&&$){if($.wkid!==4326){const w=new ce({spatialReference:$,xmax:M,ymax:D}),g=ye(w,K);M=g.xmax,D=g.ymax}if(h.xmax-h.xmin>M)throw new X("knowledge-graph:layer-data-manager",`Extent x bounds should be within ${M}° latitude, limit exceeded`);if(h.ymax-h.ymin>D)throw new X("knowledge-graph:layer-data-manager",`Extent y bounds should be within ${D}° longitude, limit exceeded`)}if(e.where!=null&&e.where!=="1=1"){const w=await De(e.where.toUpperCase(),t.fieldsIndex);t.fields.forEach(g=>{w.fieldNames.includes(g.name)&&o.add(g.name)})}s=c?`Match ()-[n:${t.objectType.name}]->() WHERE esri.graph.ST_Intersects($param_filter_geom, n.${t.geometryFieldName}) return ID(n), id(startNode(r)), id(endNode(r))`:`Match (n:${t.objectType.name}) WHERE esri.graph.ST_Intersects($param_filter_geom, n.${t.geometryFieldName}) return ID(n)`,t.geometryFieldName&&o.add(t.geometryFieldName),o.forEach(w=>{s+=`, n.${w}`,r.push(w)}),a=new te({openCypherQuery:s,bindParameters:{param_filter_geom:new Ye({rings:zt(h)})}})}else{let N="";if(e.where!=null&&e.where!=="1=1"){const $=await De(e.where,t.fieldsIndex);t.fields.forEach(g=>{$.fieldNames.includes(g.name)&&o.add(g.name)});const _=new Set(["column-reference","string","number","binary-expression"]),M=new Set(["=","<","<=","<>",">",">=","AND","OR","LIKE"]);let D=!1;const w=g=>{if(g.type==="column-reference")return`n.${g.column}`;if(g.type==="string")return`'${g.value}'`;if(g.type==="number")return`${g.value}`;if(g.type==="binary-expression"&&_.has(g.left.type)&&_.has(g.right.type)&&M.has(g.operator))return`${w(g.left)} ${g.operator} ${w(g.right)}`;if(g.type==="binary-expression"&&g.operator==="LIKE"){let W="";if(g.left.type==="function"&&g.left.args.value[0].type==="column-reference")W+=`lower(n.${g.left.args.value[0].column})`;else{if(g.left.type!=="column-reference")return D=!0,"";W+=`lower(n.${g.left.column})`}if(W+=" CONTAINS (",g.right.type!=="string")return D=!0,"";{let R=g.right.value;R.charAt(0)==="%"&&(R=R.slice(1)),R.charAt(R.length-1)==="%"&&(R=R.slice(0,-1)),W+=`'${R.toLowerCase()}')`}return W}return D=!0,""};N=w($.parseTree),D&&(N="")}let h="";h=c?`Match ()-[n:${t.objectType.name}]->()`:`Match (n:${t.objectType.name})`;let k=!1;f&&(k=!0,h+=" WHERE ID(n) IN $ids"),N&&(h+=k?" AND":" WHERE",h+=` ${N}`),h+=" return ID(n)",c&&(h+=", id(startNode(n)), id(endNode(n))"),e.returnGeometry&&t.geometryFieldName&&o.add(t.geometryFieldName),o.forEach($=>{h+=`, n.${$}`,r.push($)}),a=new te(f?{openCypherQuery:h,bindParameters:{ids:f}}:{openCypherQuery:h})}const I=(await ae(t.parentCompositeLayer.dataManager.knowledgeGraph,a,i)).resultRowsStream.getReader();for(;;){const{done:N,value:h}=await I.read();if(N)break;const k=[];for(let $=0;$<h.length;$++){const _=h[$];let M=0,D=0;const w={properties:{}};for(w.id=_[M],M++,D++,c&&(w.originId=_[M],M++,D++,w.destinationId=_[M],M++,D++);M<_.length;M++)w.properties[r[M-D]]=_[M];k.push(w)}p=p.concat(n.writeToStore(k,V,(Y=t.parentCompositeLayer.dataManager.geographicLookup.get(t.objectType.name))==null?void 0:Y.name))}return p}_isEndEntitySpatial(e,t,i){var n;for(const o of e??[])if(this.entityTypeNames.has(o)){const r=this.geographicLookup.get(o),a=r&&((n=this.sublayerCaches.get(o))==null?void 0:n.get(t.attributes[i]));if(r&&(a!=null&&a.attributes[r.name]))return!0}return!1}};d([u()],J.prototype,"knowledgeGraph",void 0),d([u()],J.prototype,"inclusionModeDefinition",void 0),d([u()],J.prototype,"entityTypeNames",void 0),d([u()],J.prototype,"relationshipTypeNames",void 0),d([u()],J.prototype,"geographicLookup",void 0),d([u()],J.prototype,"sublayerCaches",void 0),d([u()],J.prototype,"nodeConnectionsLookup",void 0),d([u()],J.prototype,"relationshipConnectionsLookup",void 0),d([u()],J.prototype,"memberIdTypeLookup",void 0),J=d([Le("esri.layers.knowledgeGraph.KnowledgeGraphLayerDataManager")],J);const Ve=at(),tn=e=>{let t=class extends e{constructor(){super(...arguments),this.fields=[],this.fieldsIndex=null}};return d([u(Ve.fields)],t.prototype,"fields",void 0),d([u(Ve.fieldsIndex)],t.prototype,"fieldsIndex",void 0),t=d([Le("esri.layers.knowledgeGraph.KnowledgeGraphSublayerBase")],t),t};function P(e){if(!e.json)return e;e.json.write=We(e.json.write);const t=e.json.origins;if(!t)return e;let i;for(i in t){const n=t[i];n&&(n.write=We(n.write))}return e}function We(e){return typeof e=="object"&&e?(e.enabled!==!1&&(e.overridePolicy=nn(e)),e):e===!0?oe():e}function nn(e){const{target:t,writer:i,overridePolicy:n,...o}=e;return function(r,a){const s=Ke.call(this,r,a);return s.enabled?{...o,...s}:s}}function oe(){return{overridePolicy:Ke}}function Ke(e,t){const i=!!this.geometryType;let n={enabled:i};return i&&(n={...n,...Xe.call(this,e,t)}),n}function Xe(e,t){return{ignoreOrigin:this.originIdOf(t)>Pt.DEFAULTS}}let T=class extends tn(ot(st(lt(pt(dt(ut(yt(ct(Bt))))))))){constructor(e){super(e),this.blendMode="normal",this.capabilities=Jt(!1,!1),this.charts=null,this.definitionExpression=null,this.displayField="",this.effect=null,this.elevationInfo=null,this.featureEffect=null,this.graphType=null,this.labelsVisible=!0,this.labelingInfo=null,this.layerType=null,this.legendEnabled=!0,this.maxScale=0,this.minScale=0,this.objectIdField=V,this.objectType=null,this.opacity=1,this.orderBy=null,this.parentCompositeLayer=null,this.persistenceEnabled=!0,this.popupEnabled=!0,this.popupTemplate=null,this.refreshInterval=0,this.source={openPorts:()=>this.load().then(()=>{const t=new MessageChannel;return new ht(t.port1,{channel:t,client:{queryFeatures:(i,n={})=>{const o=re.fromJSON(i);return this.queryFeaturesJSON(o,n)}}}),[t.port2]})},this.type="knowledge-graph-sublayer",this.useViewTime=!0,this.visible=!0}get defaultPopupTemplate(){return this.createPopupTemplate()}set featureReduction(e){const t=this._normalizeFeatureReduction(e);this._set("featureReduction",t)}get fields(){var t,i;const e=[];return(i=(t=this.objectType)==null?void 0:t.properties)==null||i.forEach(n=>{const o=n.fieldType==="esriFieldTypeOID"?"esriFieldTypeInteger":n.fieldType;e.push(ue.fromJSON({name:n.name,type:o,alias:n.alias,defaultValue:n.defaultValue,editable:n.editable,nullable:n.nullable}))}),e.push(ue.fromJSON({name:this.objectIdField,type:"esriFieldTypeString",alias:this.objectIdField,editable:!1}),ue.fromJSON({name:Me,type:"esriFieldTypeInteger",alias:Me,editable:!1}),ue.fromJSON({name:se,type:"esriFieldTypeInteger",alias:se,editable:!1})),e}get geometryType(){var i,n,o;if(((i=this.parentCompositeLayer)==null?void 0:i.type)==="link-chart")return this.graphType==="relationship"?"polyline":"point";const e=(o=this.parentCompositeLayer)==null?void 0:o.dataManager.geographicLookup.get((n=this.objectType)==null?void 0:n.name),t=e==null?void 0:e.geometryType;return t&&t!=="esriGeometryNull"?ie.fromJSON(t):null}get geometryFieldName(){var t,i,n;if(((t=this.parentCompositeLayer)==null?void 0:t.type)==="link-chart")return Ze;const e=(n=this.parentCompositeLayer)==null?void 0:n.dataManager.geographicLookup.get((i=this.objectType)==null?void 0:i.name);return(e==null?void 0:e.name)??null}get graphTypeName(){var e;return(e=this.objectType)==null?void 0:e.name}get hasM(){var n,o,r,a;const e=(o=this.parentCompositeLayer)==null?void 0:o.dataManager.geographicLookup.get((n=this.objectType)==null?void 0:n.name),t=e==null?void 0:e.name,i=t?(a=(r=this.objectType)==null?void 0:r.properties)==null?void 0:a[t]:null;return(i==null?void 0:i.hasM)??!1}get hasZ(){var n,o,r,a;const e=(o=this.parentCompositeLayer)==null?void 0:o.dataManager.geographicLookup.get((n=this.objectType)==null?void 0:n.name),t=e==null?void 0:e.name,i=t?(a=(r=this.objectType)==null?void 0:r.properties)==null?void 0:a[t]:null;return(i==null?void 0:i.hasZ)??!1}set renderer(e){mt(e,this.fieldsIndex),this._set("renderer",e)}get renderer(){var e;return this._isOverridden("renderer")?this._get("renderer"):((e=this.parentCompositeLayer)==null?void 0:e.type)==="link-chart"?this.graphType==="relationship"?fe(ge(ie.toJSON("polyline")).renderer):fe(ge(ie.toJSON("point")).renderer):fe(ge(ie.toJSON(this.geometryType)).renderer)}get spatialReference(){var e,t,i,n;return((n=(i=(t=(e=this.parentCompositeLayer)==null?void 0:e.dataManager)==null?void 0:t.knowledgeGraph)==null?void 0:i.dataModel)==null?void 0:n.spatialReference)??ft.WGS84}set timeInfo(e){(this.fieldsIndex.has((e==null?void 0:e.startField)??"")||this.fieldsIndex.has((e==null?void 0:e.endField)??""))&&gt(e,this.fieldsIndex),this._set("timeInfo",e)}get title(){return this._isOverridden("title")?this._get("title"):this.graphTypeName}set title(e){this._set("title",e)}writeTitle(e,t){t.title=e??"Layer"}createPopupTemplate(e){return Tt(this,e)}createQuery(){return new re({where:"1=1",outFields:["*"]})}getField(e){for(let t=0;t<this.fields.length;t++)if(this.fields[t].name===e)return this.fields[t];return null}getFieldDomain(e,t){return null}async queryFeatures(e,t){const{resolvedQuery:i,queryEngine:n}=await this._setupQueryObjects(e),o=bt.fromJSON(await n.executeQuery(i.toJSON(),t==null?void 0:t.signal));return o.features.forEach(r=>{r.sourceLayer=this}),o}async queryFeaturesJSON(e,t){const{resolvedQuery:i,queryEngine:n}=await this._setupQueryObjects(e);return await n.executeQuery(i.toJSON(),t==null?void 0:t.signal)}async queryFeatureCount(e,t){const{resolvedQuery:i,queryEngine:n}=await this._setupQueryObjects(e);return n.executeQueryForCount(i.toJSON(),t==null?void 0:t.signal)}async queryExtent(e={},t){var s,p,c,m;const i={...e,returnGeometry:!0},{resolvedQuery:n,queryEngine:o}=await this._setupQueryObjects(i),r=await o.executeQueryForExtent(n.toJSON(),t==null?void 0:t.signal);let a;return a=((s=r.extent)==null?void 0:s.xmin)!=null&&((p=r.extent)==null?void 0:p.xmax)!=null&&((c=r.extent)==null?void 0:c.ymin)!=null&&((m=r.extent)==null?void 0:m.ymax)!=null?new ce(r.extent):new ce,{count:r.count,extent:a}}async queryObjectIds(e,t){const i=re.from(e);let n;if(this.parentCompositeLayer.type==="link-chart"&&this._cachedQueryEngine)n=this._cachedQueryEngine;else{const o=await this.parentCompositeLayer.dataManager.getData(i,this,t);n=this.loadQueryEngine(o)}return n.executeQueryForIds(i.toJSON(),t==null?void 0:t.signal)}loadQueryEngine(e){var n;const t=new Ht({geometryType:ie.toJSON(this.geometryType),hasM:this.hasM,hasZ:this.hasZ}),i=new Qt({fieldsIndex:this.fieldsIndex.toJSON(),geometryType:ie.toJSON(this.geometryType),hasM:this.hasM,hasZ:this.hasZ,objectIdField:this.objectIdField,spatialReference:this.spatialReference.toJSON(),timeInfo:(n=this.timeInfo)==null?void 0:n.toJSON(),featureStore:t});return i.featureStore.addMany(e),i}async refreshCachedQueryEngine(){const e=await this.parentCompositeLayer.dataManager.getData(new re({where:"1=1",outFields:[V]}),this);this._cachedQueryEngine=this.loadQueryEngine(e)}async _setupQueryObjects(e,t){var r;const i=re.from(e),n=i.geometry;let o;if(n&&!((r=n.spatialReference)!=null&&r.isWGS84)&&(await we(n.spatialReference,K),i.geometry=ye(n instanceof Ye||n instanceof wt||n instanceof Et?n:n.extent,K)),this.parentCompositeLayer.type==="link-chart"&&this._cachedQueryEngine)o=this._cachedQueryEngine;else{const a=await this.parentCompositeLayer.dataManager.getData(i,this,t);o=this.loadQueryEngine(a)}return{resolvedQuery:i,queryEngine:o}}};d([u(P(q(It)))],T.prototype,"blendMode",void 0),d([u()],T.prototype,"capabilities",void 0),d([u({json:{origins:{"web-scene":{write:!1}},write:oe()}})],T.prototype,"charts",void 0),d([u({readOnly:!0})],T.prototype,"defaultPopupTemplate",null),d([u({type:String,json:{origins:{service:{read:!1}},name:"layerDefinition.definitionExpression",write:{ignoreOrigin:!0}}})],T.prototype,"definitionExpression",void 0),d([u()],T.prototype,"displayField",void 0),d([u(P(q(Lt)))],T.prototype,"effect",void 0),d([u()],T.prototype,"elevationInfo",void 0),d([u(P(q(Nt)))],T.prototype,"featureEffect",void 0),d([u(P(q(Dt)))],T.prototype,"featureReduction",null),d([u()],T.prototype,"fields",null),d([u()],T.prototype,"geometryType",null),d([u()],T.prototype,"geometryFieldName",null),d([u({type:["entity","relationship"],nonNullable:!0,json:{write:{isRequired:!0,ignoreOrigin:!0}}})],T.prototype,"graphType",void 0),d([u({type:String,nonNullable:!0,json:{write:{isRequired:!0,ignoreOrigin:!0}}})],T.prototype,"graphTypeName",null),d([u()],T.prototype,"hasM",null),d([u()],T.prototype,"hasZ",null),d([u({type:String,json:{origins:{service:{read:!1},"portal-item":{read:!1}},write:{ignoreOrigin:!0}}})],T.prototype,"id",void 0),d([u(P(q(Mt)))],T.prototype,"labelsVisible",void 0),d([u({type:[vt],json:{name:"layerDefinition.drawingInfo.labelingInfo",read:Rt,write:oe()}})],T.prototype,"labelingInfo",void 0),d([u({readOnly:!0,json:{read:!1,write:{writer(e,t){t.layerType=this.geometryType?"KnowledgeGraphSubLayer":"KnowledgeGraphSubTable"},isRequired:!0,ignoreOrigin:!0,writerEnsuresNonNull:!0}}})],T.prototype,"layerType",void 0),d([u(P(q(St)))],T.prototype,"legendEnabled",void 0),d([u(P(q($t)))],T.prototype,"maxScale",void 0),d([u(P(q(_t)))],T.prototype,"minScale",void 0),d([u()],T.prototype,"objectIdField",void 0),d([u()],T.prototype,"objectType",void 0),d([u(P(q(Ct)))],T.prototype,"opacity",void 0),d([u(P(q(kt)))],T.prototype,"orderBy",void 0),d([u()],T.prototype,"parentCompositeLayer",void 0),d([u(P(q(At)))],T.prototype,"popupEnabled",void 0),d([u({type:Ot,json:{name:"popupInfo",write:{ignoreOrigin:!0}}})],T.prototype,"popupTemplate",void 0),d([u({type:Number,json:{write:{overridePolicy:Xe}}})],T.prototype,"refreshInterval",void 0),d([u({types:xt,json:{name:"layerDefinition.drawingInfo.renderer",write:oe()}})],T.prototype,"renderer",null),d([u()],T.prototype,"source",void 0),d([u()],T.prototype,"spatialReference",null),d([u({type:jt,json:{name:"layerDefinition.timeInfo",write:!0,origins:{"web-document":{name:"layerDefinition.timeInfo",read:!0,write:!0},"portal-item":{name:"layerDefinition.timeInfo",read:!0,write:!0}}}})],T.prototype,"timeInfo",null),d([u({type:String,json:{write:{isRequired:!0,ignoreOrigin:!0,writerEnsuresNonNull:!0}}})],T.prototype,"title",null),d([Ft("title")],T.prototype,"writeTitle",null),d([u({json:{read:!1}})],T.prototype,"type",void 0),d([u(P(q(qt)))],T.prototype,"useViewTime",void 0),d([u({type:Boolean,json:{name:"visibility",write:oe()}})],T.prototype,"visible",void 0),T=d([Le("esri.layers.knowledgeGraph.KnowledgeGraphSublayer")],T);const gn=T;export{mn as A,J as E,hn as I,Fe as L,Ae as a,qe as b,yn as c,V as d,cn as e,ke as f,Me as g,xe as h,je as m,Ze as n,Se as o,Ie as r,Re as s,Ee as t,gn as u,Oe as v,fn as x};
