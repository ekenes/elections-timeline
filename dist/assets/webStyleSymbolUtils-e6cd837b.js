import{s as w,bs as v,ai as N,aj as y,bt as g,bu as $,bv as j,bw as D,bx as U,by as A,bz as h,bA as d,bB as F,bC as I}from"./index-3baa78aa.js";import{c as R,a as S}from"./devEnvironmentUtils-4eab2a99.js";function T(t,e,l,a){const n=t.name;return n==null?Promise.reject(new w("symbolstyleutils:style-symbol-reference-name-missing","Missing name in style symbol reference")):t.styleName&&t.styleName==="Esri2DPointSymbolsStyle"?C(n,e,a):v(t,e,a).then(r=>B(r,n,e,l,I,a))}function z(t,e){return e.items.find(l=>l.name===t)}function B(t,e,l,a,n,r){var f;const m=l&&l.portal!=null?l.portal:N.getDefault(),p={portal:m,url:y(t.baseUrl),origin:"portal-item"},o=z(e,t.data);if(!o){const u=`The symbol name '${e}' could not be found`;return Promise.reject(new w("symbolstyleutils:symbol-name-not-found",u,{symbolName:e}))}let i=g(n(o,a),p),b=((f=o.thumbnail)==null?void 0:f.href)??null;const c=o.thumbnail&&o.thumbnail.imageData;R()&&(i=S(i)??"",b=S(b));const P={portal:m,url:y($(i)),origin:"portal-item"};return j(i,r).then(u=>{const x=a==="cimRef"?D(u.data):u.data,s=U(x,P);if(s&&A(s)){if(b){const O=g(b,p);s.thumbnail=new h({url:O})}else c&&(s.thumbnail=new h({url:`data:image/png;base64,${c}`}));t.styleUrl?s.styleOrigin=new d({portal:l.portal,styleUrl:t.styleUrl,name:e}):t.styleName&&(s.styleOrigin=new d({portal:l.portal,styleName:t.styleName,name:e}))}return s})}function C(t,e,l){const a=F.replaceAll(/\{SymbolName\}/gi,t),n=e.portal!=null?e.portal:N.getDefault();return j(a,l).then(r=>{const m=D(r.data);return U(m,{portal:n,url:y($(a)),origin:"portal-item"})})}export{B as fetchSymbolFromStyle,z as getStyleItemFromStyle,T as resolveWebStyleSymbol};
