import{o as G}from"./floatRGBA-39c40169.js";import{am as U,an as P,ao as A}from"./index-76dad814.js";import{t as z}from"./UpdateTracking2D-5254655f.js";function B(n){var o;switch(n.type){case"CIMPointSymbol":{const r=n.symbolLayers;if(!r||r.length!==1)return null;const t=r[0];return t.type!=="CIMVectorMarker"?null:B(t)}case"CIMVectorMarker":{const r=n.markerGraphics;if(!r||r.length!==1)return null;const t=r[0];if(!t)return null;const i=t.geometry;if(!i)return null;const e=t.symbol;return!e||e.type!=="CIMPolygonSymbol"&&e.type!=="CIMLineSymbol"||(o=e.symbolLayers)!=null&&o.some(l=>!!l.effects)?null:{type:"sdf",geom:i,asFill:e.type==="CIMPolygonSymbol"}}}}function E(n){return n?n.rings?n.rings:n.paths?n.paths:n.xmin!==void 0&&n.ymin!==void 0&&n.xmax!==void 0&&n.ymax!==void 0?[[[n.xmin,n.ymin],[n.xmin,n.ymax],[n.xmax,n.ymax],[n.xmax,n.ymin],[n.xmin,n.ymin]]]:null:null}function H(n){let o=1/0,r=-1/0,t=1/0,i=-1/0;for(const e of n)for(const l of e)l[0]<o&&(o=l[0]),l[0]>r&&(r=l[0]),l[1]<t&&(t=l[1]),l[1]>i&&(i=l[1]);return new z(o,t,r-o,i-t)}function q(n){let o=1/0,r=-1/0,t=1/0,i=-1/0;for(const e of n)for(const l of e)l[0]<o&&(o=l[0]),l[0]>r&&(r=l[0]),l[1]<t&&(t=l[1]),l[1]>i&&(i=l[1]);return[o,t,r,i]}function J(n){return n?n.rings?q(n.rings):n.paths?q(n.paths):U(n)?[n.xmin,n.ymin,n.xmax,n.ymax]:null:null}function W(n){const[o,r,t,i]=J(n),e=t-o,l=i-r,a=P,m=A,f=Math.floor(.5*(.5*a-m)),s=(a-2*(f+m))/Math.max(e,l),u=Math.round(e*s),c=Math.round(l*s);return{pixelDimensions:[e,l],texelDimensions:[Math.round((u+2*f)/s),Math.round((c+2*f)/s)]}}function X(n,o,r,t,i){const[e,l,a,m]=n;if(a<e||m<l)return[0,0,0,1];const f=a-e,s=m-l,u=P,c=A,x=Math.floor(.5*(.5*u-c)),h=(u-2*(x+c))/Math.max(f,s),p=Math.round(f*h)+2*x,b=Math.round(s*h)+2*x;let w=1;o&&(w=b/h/(o.ymax-o.ymin));let y=0,g=0,d=1;t&&(i?o&&r&&o.ymax-o.ymin>0&&(d=(o.xmax-o.xmin)/(o.ymax-o.ymin),y=t.x/(r*d),g=t.y/r):(y=t.x,g=t.y)),o&&(y=.5*(o.xmax+o.xmin)+y*(o.xmax-o.xmin),g=.5*(o.ymax+o.ymin)+g*(o.ymax-o.ymin)),y-=e,g-=l,y*=h,g*=h,y+=x,g+=x;let M=y/p-.5,C=g/b-.5;return i&&r&&(M*=r*d,C*=r),[w,M,C,d]}function Y(n){const o=E(n.geom),r=H(o),t=P,i=A,e=Math.floor(.5*(.5*t-i)),l=(t-2*(e+i))/Math.max(r.width,r.height),a=Math.round(r.width*l)+2*e,m=Math.round(r.height*l)+2*e,f=[];for(const u of o)if(u&&u.length>1){const c=[];for(const x of u){let[h,p]=x;h-=r.x,p-=r.y,h*=l,p*=l,h+=e-.5,p+=e-.5,n.asFill?c.push([h,p]):c.push([Math.round(h),Math.round(p)])}if(n.asFill){const x=c.length-1;c[0][0]===c[x][0]&&c[0][1]===c[x][1]||c.push(c[0])}f.push(c)}const s=K(f,a,m,e);return n.asFill&&N(f,a,m,e,s),[O(s,e),a,m]}function K(n,o,r,t){const i=o*r,e=new Array(i),l=t*t+1;for(let a=0;a<i;++a)e[a]=l;for(const a of n){const m=a.length;for(let f=1;f<m;++f){const s=a[f-1],u=a[f];let c,x,h,p;s[0]<u[0]?(c=s[0],x=u[0]):(c=u[0],x=s[0]),s[1]<u[1]?(h=s[1],p=u[1]):(h=u[1],p=s[1]);let b=Math.floor(c)-t,w=Math.floor(x)+t,y=Math.floor(h)-t,g=Math.floor(p)+t;b<0&&(b=0),w>o&&(w=o),y<0&&(y=0),g>r&&(g=r);const d=u[0]-s[0],M=u[1]-s[1],C=d*d+M*M;for(let S=b;S<w;S++)for(let k=y;k<g;k++){const D=S+.5,L=k+.5;let I,v,F=(D-s[0])*d+(L-s[1])*M;F<0?(I=s[0],v=s[1]):F>C?(I=u[0],v=u[1]):(F/=C,I=s[0]+F*d,v=s[1]+F*M);const V=(D-I)*(D-I)+(L-v)*(L-v),j=(r-k-1)*o+S;V<e[j]&&(e[j]=V)}}}for(let a=0;a<i;++a)e[a]=Math.sqrt(e[a]);return e}function N(n,o,r,t,i){for(const e of n){const l=e.length;for(let a=1;a<l;++a){const m=e[a-1],f=e[a];let s,u,c,x;m[0]<f[0]?(s=m[0],u=f[0]):(s=f[0],u=m[0]),m[1]<f[1]?(c=m[1],x=f[1]):(c=f[1],x=m[1]);let h=Math.floor(s),p=Math.floor(u)+1,b=Math.floor(c),w=Math.floor(x)+1;h<t&&(h=t),p>o-t&&(p=o-t),b<t&&(b=t),w>r-t&&(w=r-t);for(let y=b;y<w;++y){if(m[1]>y==f[1]>y)continue;const g=y+.5,d=(r-y-1)*o;for(let M=h;M<p;++M)M+.5<(f[0]-m[0])*(g-m[1])/(f[1]-m[1])+m[0]&&(i[d+M]=-i[d+M]);for(let M=t;M<h;++M)i[d+M]=-i[d+M]}}}}function O(n,o){const r=2*o,t=n.length,i=new Uint8Array(4*t);for(let e=0;e<t;++e){const l=.5-n[e]/r;G(l,i,4*e)}return i}export{J as a,X as c,B as l,W as m,Y as u};
