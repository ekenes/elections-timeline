{"version":3,"file":"SDFHelper-10b45441.js","sources":["../../node_modules/@arcgis/core/symbols/cim/SDFHelper.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport{packFloatRGBA as t}from\"../../core/floatRGBA.js\";import{isExtent as o}from\"../../geometry/support/jsonUtils.js\";import n from\"./Rect.js\";import{defaultSdfTextureSize as r,spritePadding as e}from\"../../views/2d/engine/webgl/definitions.js\";function l(t){switch(t.type){case\"CIMPointSymbol\":{const o=t.symbolLayers;if(!o||1!==o.length)return null;const n=o[0];return\"CIMVectorMarker\"!==n.type?null:l(n)}case\"CIMVectorMarker\":{const o=t.markerGraphics;if(!o||1!==o.length)return null;const n=o[0];if(!n)return null;const r=n.geometry;if(!r)return null;const e=n.symbol;return!e||\"CIMPolygonSymbol\"!==e.type&&\"CIMLineSymbol\"!==e.type||e.symbolLayers?.some((t=>!!t.effects))?null:{type:\"sdf\",geom:r,asFill:\"CIMPolygonSymbol\"===e.type}}}}function i(t){return t?t.rings?t.rings:t.paths?t.paths:void 0!==t.xmin&&void 0!==t.ymin&&void 0!==t.xmax&&void 0!==t.ymax?[[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]]]:null:null}function s(t){let o=1/0,r=-1/0,e=1/0,l=-1/0;for(const n of t)for(const t of n)t[0]<o&&(o=t[0]),t[0]>r&&(r=t[0]),t[1]<e&&(e=t[1]),t[1]>l&&(l=t[1]);return new n(o,e,r-o,l-e)}function f(t){let o=1/0,n=-1/0,r=1/0,e=-1/0;for(const l of t)for(const t of l)t[0]<o&&(o=t[0]),t[0]>n&&(n=t[0]),t[1]<r&&(r=t[1]),t[1]>e&&(e=t[1]);return[o,r,n,e]}function m(t){return t?t.rings?f(t.rings):t.paths?f(t.paths):o(t)?[t.xmin,t.ymin,t.xmax,t.ymax]:null:null}function a(t,o,n,l,i){const[s,f,m,a]=t;if(m<s||a<f)return[0,0,0,1];const c=m-s,u=a-f,y=r,h=e,x=Math.floor(.5*(.5*y-h)),M=(y-2*(x+h))/Math.max(c,u),p=Math.round(c*M)+2*x,g=Math.round(u*M)+2*x;let d=1;if(o){d=g/M/(o.ymax-o.ymin)}let b=0,w=0,C=1;l&&(i?o&&n&&o.ymax-o.ymin>0&&(C=(o.xmax-o.xmin)/(o.ymax-o.ymin),b=l.x/(n*C),w=l.y/n):(b=l.x,w=l.y)),o&&(b=.5*(o.xmax+o.xmin)+b*(o.xmax-o.xmin),w=.5*(o.ymax+o.ymin)+w*(o.ymax-o.ymin)),b-=s,w-=f,b*=M,w*=M,b+=x,w+=x;let I=b/p-.5,j=w/g-.5;return i&&n&&(I*=n*C,j*=n),[d,I,j,C]}function c(t){const o=i(t.geom),n=s(o),l=r,f=e,m=Math.floor(.5*(.5*l-f)),a=(l-2*(m+f))/Math.max(n.width,n.height),c=Math.round(n.width*a)+2*m,x=Math.round(n.height*a)+2*m,M=[];for(const r of o)if(r&&r.length>1){const o=[];for(const e of r){let[r,l]=e;r-=n.x,l-=n.y,r*=a,l*=a,r+=m-.5,l+=m-.5,t.asFill?o.push([r,l]):o.push([Math.round(r),Math.round(l)])}if(t.asFill){const t=o.length-1;o[0][0]===o[t][0]&&o[0][1]===o[t][1]||o.push(o[0])}M.push(o)}const p=u(M,c,x,m);return t.asFill&&y(M,c,x,m,p),[h(p,m),c,x]}function u(t,o,n,r){const e=o*n,l=new Array(e),i=r*r+1;for(let s=0;s<e;++s)l[s]=i;for(const s of t){const t=s.length;for(let e=1;e<t;++e){const t=s[e-1],i=s[e];let f,m,a,c;t[0]<i[0]?(f=t[0],m=i[0]):(f=i[0],m=t[0]),t[1]<i[1]?(a=t[1],c=i[1]):(a=i[1],c=t[1]);let u=Math.floor(f)-r,y=Math.floor(m)+r,h=Math.floor(a)-r,x=Math.floor(c)+r;u<0&&(u=0),y>o&&(y=o),h<0&&(h=0),x>n&&(x=n);const M=i[0]-t[0],p=i[1]-t[1],g=M*M+p*p;for(let r=u;r<y;r++)for(let e=h;e<x;e++){const s=r+.5,f=e+.5;let m,a,c=(s-t[0])*M+(f-t[1])*p;c<0?(m=t[0],a=t[1]):c>g?(m=i[0],a=i[1]):(c/=g,m=t[0]+c*M,a=t[1]+c*p);const u=(s-m)*(s-m)+(f-a)*(f-a),y=(n-e-1)*o+r;u<l[y]&&(l[y]=u)}}}for(let s=0;s<e;++s)l[s]=Math.sqrt(l[s]);return l}function y(t,o,n,r,e){for(const l of t){const t=l.length;for(let i=1;i<t;++i){const t=l[i-1],s=l[i];let f,m,a,c;t[0]<s[0]?(f=t[0],m=s[0]):(f=s[0],m=t[0]),t[1]<s[1]?(a=t[1],c=s[1]):(a=s[1],c=t[1]);let u=Math.floor(f),y=Math.floor(m)+1,h=Math.floor(a),x=Math.floor(c)+1;u<r&&(u=r),y>o-r&&(y=o-r),h<r&&(h=r),x>n-r&&(x=n-r);for(let l=h;l<x;++l){if(t[1]>l==s[1]>l)continue;const i=l+.5,f=(n-l-1)*o;for(let o=u;o<y;++o){o+.5<(s[0]-t[0])*(i-t[1])/(s[1]-t[1])+t[0]&&(e[f+o]=-e[f+o])}for(let t=r;t<u;++t)e[f+t]=-e[f+t]}}}}function h(o,n){const r=2*n,e=o.length,l=new Uint8Array(4*e);for(let i=0;i<e;++i){const n=.5-o[i]/r;t(n,l,4*i)}return l}export{c as buildSDF,m as getExtent,l as getSDFInfo,a as getSDFMetrics};\n"],"names":["l","t","o","n","r","e","_a","i","s","f","m","a","c","u","y","h","M","g","d","b","w","C","I","j","x","p"],"mappings":"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","x_google_ignoreList":[0]}