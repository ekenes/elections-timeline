{"version":3,"file":"executeQueryPBF-ff6801c7.js","sources":["../../node_modules/@arcgis/core/rest/query/operations/pbfJSONFeatureSet.js","../../node_modules/@arcgis/core/rest/query/executeQueryPBF.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport{assertIsSome as e}from\"../../../core/maybe.js\";import{getGeometryZScaler as t}from\"../../../geometry/support/zscale.js\";import{unquantizeOptimizedGeometry as r,convertToGeometry as s}from\"../../../layers/graphics/featureConversionUtils.js\";function o(e,t){return t}function i(e,t,r,s){switch(r){case 0:return u(e,t+s,0);case 1:return\"lowerLeft\"===e.originPosition?u(e,t+s,1):l(e,t+s,1)}}function n(e,t,r,s){return 2===r?u(e,t,2):i(e,t,r,s)}function a(e,t,r,s){return 2===r?0===t?0:u(e,t,3):i(e,t,r,s)}function h(e,t,r,s){return 3===r?0===t?0:u(e,t,3):n(e,t,r,s)}function u({translate:e,scale:t},r,s){return e[s]+r*t[s]}function l({translate:e,scale:t},r,s){return e[s]-r*t[s]}class d{constructor(e){this._options=e,this.geometryTypes=[\"esriGeometryPoint\",\"esriGeometryMultipoint\",\"esriGeometryPolyline\",\"esriGeometryPolygon\"],this._previousCoordinate=[0,0],this._transform=null,this._applyTransform=o,this._lengths=[],this._currentLengthIndex=0,this._toAddInCurrentPath=0,this._vertexDimension=0,this._mValueOffset=null,this._coordinateBuffer=null,this._coordinateBufferPtr=0,this._attributesConstructor=class{}}createFeatureResult(){return{fields:[],features:[]}}finishFeatureResult(e){if(this._options.applyTransform&&(e.transform=null),this._attributesConstructor=class{},this._coordinateBuffer=null,this._lengths.length=0,!e.hasZ)return;const r=t(e.geometryType,this._options.sourceSpatialReference,e.spatialReference);if(null!=r)for(const t of e.features)r(t.geometry)}createSpatialReference(){return{}}addField(t,r){const s=t.fields;e(s),s.push(r);const o=s.map((e=>e.name));this._attributesConstructor=function(){for(const e of o)this[e]=null}}addFeature(e,t){e.features.push(t)}prepareFeatures(e){switch(this._transform=e.transform,this._options.applyTransform&&e.transform&&(this._applyTransform=this._deriveApplyTransform(e)),this._mValueOffset=null,this._vertexDimension=2,e.hasZ&&this._vertexDimension++,e.hasM&&(this._mValueOffset=this._vertexDimension,this._vertexDimension++),e.geometryType){case\"esriGeometryPoint\":this.addCoordinate=(e,t,r)=>this.addCoordinatePoint(e,t,r),this.createGeometry=e=>this.createPointGeometry(e);break;case\"esriGeometryPolygon\":this.addCoordinate=(e,t,r)=>this._addCoordinatePolygon(e,t,r),this.createGeometry=e=>this._createPolygonGeometry(e);break;case\"esriGeometryPolyline\":this.addCoordinate=(e,t,r)=>this._addCoordinatePolyline(e,t,r),this.createGeometry=e=>this._createPolylineGeometry(e);break;case\"esriGeometryMultipoint\":this.addCoordinate=(e,t,r)=>this._addCoordinateMultipoint(e,t,r),this.createGeometry=e=>this._createMultipointGeometry(e)}}createFeature(){return this._lengths.length=0,this._currentLengthIndex=0,this._previousCoordinate[0]=0,this._previousCoordinate[1]=0,this._coordinateBuffer=null,this._coordinateBufferPtr=0,{attributes:new this._attributesConstructor}}allocateCoordinates(){}addLength(e,t,r){0===this._lengths.length&&(this._toAddInCurrentPath=t),this._lengths.push(t)}addQueryGeometry(e,t){const{queryGeometry:o,queryGeometryType:i}=t,n=r(o.clone(),o,!1,!1,this._transform),a=s(n,i,!1,!1);e.queryGeometryType=i,e.queryGeometry={...a}}createPointGeometry(e){const t={x:0,y:0,spatialReference:e.spatialReference};return e.hasZ&&(t.z=0),e.hasM&&(t.m=0),t}addCoordinatePoint(e,t,r){const s=this._transform;switch(t=this._applyTransform(s,t,r,0),r){case 0:e.x=t;break;case 1:e.y=t;break;case 2:\"z\"in e?e.z=t:e.m=t;break;case 3:e.m=t}}_transformPathLikeValue(e,t){let r=0;t<=1&&(r=this._previousCoordinate[t],this._previousCoordinate[t]+=e);const s=this._transform;return null!==this._mValueOffset&&0===e&&t>0&&!(t%this._mValueOffset)?0:this._applyTransform(s,e,t,r)}_addCoordinatePolyline(e,t,r){this._dehydratedAddPointsCoordinate(e.paths,t,r)}_addCoordinatePolygon(e,t,r){this._dehydratedAddPointsCoordinate(e.rings,t,r)}_addCoordinateMultipoint(e,t,r){0===r&&e.points.push([]);const s=this._transformPathLikeValue(t,r);e.points[e.points.length-1].push(s)}_createPolygonGeometry(e){return{rings:[[]],spatialReference:e.spatialReference,hasZ:!!e.hasZ,hasM:!!e.hasM}}_createPolylineGeometry(e){return{paths:[[]],spatialReference:e.spatialReference,hasZ:!!e.hasZ,hasM:!!e.hasM}}_createMultipointGeometry(e){return{points:[],spatialReference:e.spatialReference,hasZ:!!e.hasZ,hasM:!!e.hasM}}_dehydratedAddPointsCoordinate(e,t,r){0===r&&0==this._toAddInCurrentPath--&&(e.push([]),this._toAddInCurrentPath=this._lengths[++this._currentLengthIndex]-1,this._previousCoordinate[0]=0,this._previousCoordinate[1]=0);const s=this._transformPathLikeValue(t,r),o=e[e.length-1];0===r&&(this._coordinateBufferPtr=0,this._coordinateBuffer=new Array(this._vertexDimension),o.push(this._coordinateBuffer)),this._coordinateBuffer[this._coordinateBufferPtr++]=s}_deriveApplyTransform(e){const{hasZ:t,hasM:r}=e;return t&&r?h:t?n:r?a:i}}export{d as JSONFeatureSetParserContext};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport{parseUrl as r}from\"../utils.js\";import{JSONFeatureSetParserContext as e}from\"./operations/pbfJSONFeatureSet.js\";import{executeQueryPBF as t}from\"./operations/query.js\";import o from\"../support/FeatureSet.js\";import a from\"../support/Query.js\";async function s(r,e,t){const s=await n(r,a.from(e),t);return o.fromJSON(s)}async function n(o,s,n){const p=r(o),i={...n},u=a.from(s),m=!u.quantizationParameters,{data:f}=await t(p,u,new e({sourceSpatialReference:u.sourceSpatialReference,applyTransform:m}),i);return f}export{s as executeQueryPBF,n as executeRawQueryPBF};\n"],"names":["o","e","i","r","s","u","l","n","a","h","d","t","p","m","f"],"mappings":"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","x_google_ignoreList":[0,1]}